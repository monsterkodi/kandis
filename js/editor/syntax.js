// koffee 1.7.0

/*
 0000000  000   000  000   000  000000000   0000000   000   000
000        000 000   0000  000     000     000   000   000 000
0000000     00000    000 0 000     000     000000000    00000
     000     000     000  0000     000     000   000   000 000
0000000      000     000   000     000     000   000  000   000
 */
var Syntax, _, elem, fs, kerror, klor, kstr, last, matchr, noon, ref, slash,
    indexOf = [].indexOf;

ref = require('kxk'), _ = ref._, elem = ref.elem, fs = ref.fs, kerror = ref.kerror, klor = ref.klor, kstr = ref.kstr, last = ref.last, matchr = ref.matchr, noon = ref.noon, slash = ref.slash;

Syntax = (function() {
    function Syntax(name, getLine, getLines) {
        this.name = name;
        this.getLine = getLine;
        this.getLines = getLines;
        this.diss = [];
        this.colors = {};
    }

    Syntax.prototype.newDiss = function(li) {
        var diss;
        diss = klor.dissect([this.getLine(li)], this.name)[0];
        return diss;
    };

    Syntax.prototype.getDiss = function(li) {
        if (this.diss[li] == null) {
            this.diss[li] = this.newDiss(li);
        }
        return this.diss[li];
    };

    Syntax.prototype.setDiss = function(li, dss) {
        this.diss[li] = dss;
        return dss;
    };

    Syntax.prototype.fillDiss = function(bot) {
        var i, li, ref1, results;
        results = [];
        for (li = i = 0, ref1 = bot; 0 <= ref1 ? i <= ref1 : i >= ref1; li = 0 <= ref1 ? ++i : --i) {
            results.push(this.getDiss(li));
        }
        return results;
    };

    Syntax.prototype.setLines = function(lines) {
        return this.diss = klor.dissect(lines, this.name);
    };

    Syntax.prototype.changed = function(changeInfo) {
        var ch, change, di, i, len, li, ref1, ref2, results;
        ref1 = changeInfo.changes;
        results = [];
        for (i = 0, len = ref1.length; i < len; i++) {
            change = ref1[i];
            ref2 = [change.doIndex, change.newIndex, change.change], di = ref2[0], li = ref2[1], ch = ref2[2];
            switch (ch) {
                case 'changed':
                    results.push(this.diss[di] = this.newDiss(di));
                    break;
                case 'deleted':
                    results.push(this.diss.splice(di, 1));
                    break;
                case 'inserted':
                    results.push(this.diss.splice(di, 0, this.newDiss(di)));
                    break;
                default:
                    results.push(void 0);
            }
        }
        return results;
    };

    Syntax.prototype.setFileType = function(fileType) {
        return this.name = fileType;
    };

    Syntax.prototype.clear = function() {
        return this.diss = [];
    };

    Syntax.prototype.colorForClassnames = function(clss) {
        var color, computedStyle, div, opacity;
        if (this.colors[clss] == null) {
            div = elem({
                "class": clss
            });
            document.body.appendChild(div);
            computedStyle = window.getComputedStyle(div);
            color = computedStyle.color;
            opacity = computedStyle.opacity;
            if (opacity !== '1') {
                color = 'rgba(' + color.slice(4, color.length - 2) + ', ' + opacity + ')';
            }
            this.colors[clss] = color;
            div.remove();
        }
        return this.colors[clss];
    };

    Syntax.prototype.colorForStyle = function(styl) {
        var div;
        if (this.colors[styl] == null) {
            div = elem('div');
            div.style = styl;
            document.body.appendChild(div);
            this.colors[styl] = window.getComputedStyle(div).color;
            div.remove();
        }
        return this.colors[styl];
    };

    Syntax.prototype.schemeChanged = function() {
        return this.colors = {};
    };


    /*
     0000000  000000000   0000000   000000000  000   0000000
    000          000     000   000     000     000  000
    0000000      000     000000000     000     000  000
         000     000     000   000     000     000  000
    0000000      000     000   000     000     000   0000000
     */

    Syntax.matchrConfigs = {};

    Syntax.syntaxNames = [];

    Syntax.spanForText = function(text) {
        return this.spanForTextAndSyntax(text, 'ko');
    };

    Syntax.spanForTextAndSyntax = function(text, n) {
        var clrzd, clss, d, di, diss, i, j, l, ref1, ref2, ref3, sp, spc, style;
        l = "";
        diss = this.dissForTextAndSyntax(text, n);
        if (diss != null ? diss.length : void 0) {
            last = 0;
            for (di = i = 0, ref1 = diss.length; 0 <= ref1 ? i < ref1 : i > ref1; di = 0 <= ref1 ? ++i : --i) {
                d = diss[di];
                style = (d.styl != null) && d.styl.length && (" style=\"" + d.styl + "\"") || '';
                spc = '';
                for (sp = j = ref2 = last, ref3 = d.start; ref2 <= ref3 ? j < ref3 : j > ref3; sp = ref2 <= ref3 ? ++j : --j) {
                    spc += '&nbsp;';
                }
                last = d.start + d.match.length;
                clss = (d.clss != null) && d.clss.length && (" class=\"" + d.clss + "\"") || '';
                clrzd = "<span" + style + clss + ">" + spc + (kstr.encode(d.match)) + "</span>";
                l += clrzd;
            }
        }
        return l;
    };

    Syntax.rangesForTextAndSyntax = function(line, n) {
        return matchr.ranges(Syntax.matchrConfigs[n], line);
    };

    Syntax.dissForTextAndSyntax = function(text, n) {
        var result;
        if (n !== 'browser' && n !== 'ko' && n !== 'commandline' && n !== 'macro' && n !== 'term' && n !== 'test') {
            result = klor.ranges(text, n);
        } else {
            if ((n == null) || (Syntax.matchrConfigs[n] == null)) {
                return kerror("no syntax? " + n);
            }
            result = matchr.dissect(matchr.ranges(Syntax.matchrConfigs[n], text));
        }
        return result;
    };

    Syntax.lineForDiss = function(dss) {
        var d, i, l, len;
        l = "";
        for (i = 0, len = dss.length; i < len; i++) {
            d = dss[i];
            l = _.padEnd(l, d.start);
            l += d.match;
        }
        return l;
    };

    Syntax.shebang = function(line) {
        var lastWord;
        if (line.startsWith("#!")) {
            lastWord = _.last(line.split(/[\s\/]/));
            switch (lastWord) {
                case 'python':
                    return 'py';
                case 'node':
                    return 'js';
                case 'bash':
                    return 'sh';
                default:
                    if (indexOf.call(this.syntaxNames, lastWord) >= 0) {
                        return lastWord;
                    }
            }
        }
        return 'txt';
    };

    Syntax.init = function() {
        var config, extnames, i, j, len, len1, patterns, ref1, ref2, syntaxDir, syntaxFile, syntaxName;
        syntaxDir = __dirname + "/../../syntax/";
        ref1 = fs.readdirSync(syntaxDir);
        for (i = 0, len = ref1.length; i < len; i++) {
            syntaxFile = ref1[i];
            syntaxName = slash.basename(syntaxFile, '.noon');
            patterns = noon.load(slash.join(syntaxDir, syntaxFile));
            patterns['\\w+'] = 'text';
            patterns['[^\\w\\s]+'] = 'syntax';
            if (((ref2 = patterns.ko) != null ? ref2.extnames : void 0) != null) {
                extnames = patterns.ko.extnames;
                delete patterns.ko;
                config = matchr.config(patterns);
                for (j = 0, len1 = extnames.length; j < len1; j++) {
                    syntaxName = extnames[j];
                    this.syntaxNames.push(syntaxName);
                    this.matchrConfigs[syntaxName] = config;
                }
            } else {
                this.syntaxNames.push(syntaxName);
                this.matchrConfigs[syntaxName] = matchr.config(patterns);
            }
        }
        return this.syntaxNames = this.syntaxNames.concat(klor.exts);
    };

    return Syntax;

})();

Syntax.init();

module.exports = Syntax;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3ludGF4LmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQSx1RUFBQTtJQUFBOztBQVFBLE1BQWlFLE9BQUEsQ0FBUSxLQUFSLENBQWpFLEVBQUUsU0FBRixFQUFLLGVBQUwsRUFBVyxXQUFYLEVBQWUsbUJBQWYsRUFBdUIsZUFBdkIsRUFBNkIsZUFBN0IsRUFBbUMsZUFBbkMsRUFBeUMsbUJBQXpDLEVBQWlELGVBQWpELEVBQXVEOztBQUVqRDtJQUVDLGdCQUFDLElBQUQsRUFBUSxPQUFSLEVBQWtCLFFBQWxCO1FBQUMsSUFBQyxDQUFBLE9BQUQ7UUFBTyxJQUFDLENBQUEsVUFBRDtRQUFVLElBQUMsQ0FBQSxXQUFEO1FBRWpCLElBQUMsQ0FBQSxJQUFELEdBQVU7UUFDVixJQUFDLENBQUEsTUFBRCxHQUFVO0lBSFg7O3FCQVdILE9BQUEsR0FBUyxTQUFDLEVBQUQ7QUFFTCxZQUFBO1FBQUEsSUFBQSxHQUFPLElBQUksQ0FBQyxPQUFMLENBQWEsQ0FBQyxJQUFDLENBQUEsT0FBRCxDQUFTLEVBQVQsQ0FBRCxDQUFiLEVBQTRCLElBQUMsQ0FBQSxJQUE3QixDQUFtQyxDQUFBLENBQUE7ZUFDMUM7SUFISzs7cUJBS1QsT0FBQSxHQUFTLFNBQUMsRUFBRDtRQUVMLElBQU8scUJBQVA7WUFDSSxJQUFDLENBQUEsSUFBSyxDQUFBLEVBQUEsQ0FBTixHQUFZLElBQUMsQ0FBQSxPQUFELENBQVMsRUFBVCxFQURoQjs7ZUFHQSxJQUFDLENBQUEsSUFBSyxDQUFBLEVBQUE7SUFMRDs7cUJBT1QsT0FBQSxHQUFTLFNBQUMsRUFBRCxFQUFLLEdBQUw7UUFFTCxJQUFDLENBQUEsSUFBSyxDQUFBLEVBQUEsQ0FBTixHQUFZO2VBQ1o7SUFISzs7cUJBS1QsUUFBQSxHQUFVLFNBQUMsR0FBRDtBQUVOLFlBQUE7QUFBQTthQUFVLHFGQUFWO3lCQUNJLElBQUMsQ0FBQSxPQUFELENBQVMs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UUFBQSxTQUFBLEdBQWUsU0FBRCxHQUFXO0FBRXpCO0FBQUEsYUFBQSxzQ0FBQTs7WUFFSSxVQUFBLEdBQWEsS0FBSyxDQUFDLFFBQU4sQ0FBZSxVQUFmLEVBQTJCLE9BQTNCO1lBQ2IsUUFBQSxHQUFXLElBQUksQ0FBQyxJQUFMLENBQVUsS0FBSyxDQUFDLElBQU4sQ0FBVyxTQUFYLEVBQXNCLFVBQXRCLENBQVY7WUFFWCxRQUFTLENBQUEsTUFBQSxDQUFULEdBQXlCO1lBQ3pCLFFBQVMsQ0FBQSxZQUFBLENBQVQsR0FBeUI7WUFFekIsSUFBRywrREFBSDtnQkFDSSxRQUFBLEdBQVcsUUFBUSxDQUFDLEVBQUUsQ0FBQztnQkFDdkIsT0FBTyxRQUFRLENBQUM7Z0JBRWhCLE1BQUEsR0FBUyxNQUFNLENBQUMsTUFBUCxDQUFjLFFBQWQ7QUFDVCxxQkFBQSw0Q0FBQTs7b0JBQ0ksSUFBQyxDQUFBLFdBQVcsQ0FBQyxJQUFiLENBQWtCLFVBQWxCO29CQUNBLElBQUMsQ0FBQSxhQUFjLENBQUEsVUFBQSxDQUFmLEdBQTZCO0FBRmpDLGlCQUxKO2FBQUEsTUFBQTtnQkFTSSxJQUFDLENBQUEsV0FBVyxDQUFDLElBQWIsQ0FBa0IsVUFBbEI7Z0JBQ0EsSUFBQyxDQUFBLGFBQWMsQ0FBQSxVQUFBLENBQWYsR0FBNkIsTUFBTSxDQUFDLE1BQVAsQ0FBYyxRQUFkLEVBVmpDOztBQVJKO2VBcUJBLElBQUMsQ0FBQSxXQUFELEdBQWUsSUFBQyxDQUFBLFdBQVcsQ0FBQyxNQUFiLENBQW9CLElBQUksQ0FBQyxJQUF6QjtJQXpCWjs7Ozs7O0FBMkJYLE1BQU0sQ0FBQyxJQUFQLENBQUE7O0FBQ0EsTUFBTSxDQUFDLE9BQVAsR0FBaUIiLCJzb3VyY2VzQ29udGVudCI6WyIjIyNcbiAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMFxuMDAwICAgICAgICAwMDAgMDAwICAgMDAwMCAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgIDAwMCAwMDBcbjAwMDAwMDAgICAgIDAwMDAwICAgIDAwMCAwIDAwMCAgICAgMDAwICAgICAwMDAwMDAwMDAgICAgMDAwMDBcbiAgICAgMDAwICAgICAwMDAgICAgIDAwMCAgMDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgICAwMDAgMDAwXG4wMDAwMDAwICAgICAgMDAwICAgICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAwMDBcbiMjI1xuXG57IF8sIGVsZW0sIGZzLCBrZXJyb3IsIGtsb3IsIGtzdHIsIGxhc3QsIG1hdGNociwgbm9vbiwgc2xhc2ggfSA9IHJlcXVpcmUgJ2t4aydcblxuY2xhc3MgU3ludGF4XG4gICAgXG4gICAgQDogKEBuYW1lLCBAZ2V0TGluZSwgQGdldExpbmVzKSAtPlxuXG4gICAgICAgIEBkaXNzICAgPSBbXVxuICAgICAgICBAY29sb3JzID0ge31cblxuICAgICMgMDAwMDAwMCAgICAwMDAgICAwMDAwMDAwICAgMDAwMDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAgIDAwMCAgICAgICAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAwMDAwMDAwICAgMDAwMDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIDAwMFxuICAgICMgMDAwMDAwMCAgICAwMDAgIDAwMDAwMDAgICAwMDAwMDAwXG5cbiAgICBuZXdEaXNzOiAobGkpIC0+XG4gICAgICAgIFxuICAgICAgICBkaXNzID0ga2xvci5kaXNzZWN0KFtAZ2V0TGluZSBsaV0sIEBuYW1lKVswXVxuICAgICAgICBkaXNzXG5cbiAgICBnZXREaXNzOiAobGkpIC0+XG5cbiAgICAgICAgaWYgbm90IEBkaXNzW2xpXT9cbiAgICAgICAgICAgIEBkaXNzW2xpXSA9IEBuZXdEaXNzIGxpXG5cbiAgICAgICAgQGRpc3NbbGldXG5cbiAgICBzZXREaXNzOiAobGksIGRzcykgLT5cblxuICAgICAgICBAZGlzc1tsaV0gPSBkc3NcbiAgICAgICAgZHNzXG5cbiAgICBmaWxsRGlzczogKGJvdCkgLT5cblxuICAgICAgICBmb3IgbGkgaW4gWzAuLmJvdF1cbiAgICAgICAgICAgIEBnZXREaXNzIGxpXG5cbiAgICAjICAwMDAwMDAwICAwMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAgICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAgICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICBcbiAgICAjIDAwMDAwMDAgICAwMDAwMDAwICAgICAgMDAwICAgICAwMDAgICAgICAwMDAgIDAwMCAwIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgICBcbiAgICAjICAgICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgICAgICAgICAgMDAwICBcbiAgICAjIDAwMDAwMDAgICAwMDAwMDAwMCAgICAgMDAwICAgICAwMDAwMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAgICBcbiAgICBcbiAgICBzZXRMaW5lczogKGxpbmVzKSAtPlxuICAgICAgICBcbiAgICAgICAgQGRpc3MgPSBrbG9yLmRpc3NlY3QgbGluZXMsIEBuYW1lXG4gICAgICAgICAgICBcbiAgICAjICAwMDAwMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAwMDAwMDAwXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgICAwMDAgICAgICAgMDAwICAgMDAwXG4gICAgIyAwMDAgICAgICAgMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMCAwIDAwMCAgMDAwICAwMDAwICAwMDAwMDAwICAgMDAwICAgMDAwXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwXG4gICAgIyAgMDAwMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgMDAwMDAwMFxuXG4gICAgY2hhbmdlZDogKGNoYW5nZUluZm8pIC0+XG5cbiAgICAgICAgIyBpZiB2YWxpZCBjaGFuZ2VJbmZvLmNoYW5nZXNcbiAgICAgICAgICAgICMgQGJsb2NrcyA9IG51bGxcbiAgICAgICAgXG4gICAgICAgIGZvciBjaGFuZ2UgaW4gY2hhbmdlSW5mby5jaGFuZ2VzXG5cbiAgICAgICAgICAgIFtkaSxsaSxjaF0gPSBbY2hhbmdlLmRvSW5kZXgsIGNoYW5nZS5uZXdJbmRleCwgY2hhbmdlLmNoYW5nZV1cblxuICAgICAgICAgICAgc3dpdGNoIGNoXG5cbiAgICAgICAgICAgICAgICB3aGVuICdjaGFuZ2VkJ1xuXG4gICAgICAgICAgICAgICAgICAgIEBkaXNzW2RpXSA9IEBuZXdEaXNzIGRpXG5cbiAgICAgICAgICAgICAgICB3aGVuICdkZWxldGVkJ1xuXG4gICAgICAgICAgICAgICAgICAgIEBkaXNzLnNwbGljZSBkaSwgMVxuXG4gICAgICAgICAgICAgICAgd2hlbiAnaW5zZXJ0ZWQnXG5cbiAgICAgICAgICAgICAgICAgICAgQGRpc3Muc3BsaWNlIGRpLCAwLCBAbmV3RGlzcyBkaVxuXG4gICAgc2V0RmlsZVR5cGU6IChmaWxlVHlwZSkgLT5cblxuICAgICAgICAjIGtsb2cgJ1N5bnRheC5zZXRGaWxlVHlwZScgZmlsZVR5cGVcbiAgICAgICAgXG4gICAgICAgIEBuYW1lID0gZmlsZVR5cGVcbiAgICAgICAgXG4gICAgIyAgMDAwMDAwMCAgMDAwICAgICAgMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAwMDAwXG4gICAgIyAwMDAgICAgICAgMDAwICAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwXG4gICAgIyAgMDAwMDAwMCAgMDAwMDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwXG5cbiAgICBjbGVhcjogLT5cblxuICAgICAgICBAZGlzcyA9IFtdXG5cbiAgICAjICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAgICAgICAwMDAwMDAwICAgMDAwMDAwMDBcbiAgICAjIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAwMDAgIDAwMDAwMDBcbiAgICAjIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwXG4gICAgIyAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMFxuXG4gICAgY29sb3JGb3JDbGFzc25hbWVzOiAoY2xzcykgLT5cblxuICAgICAgICBpZiBub3QgQGNvbG9yc1tjbHNzXT9cblxuICAgICAgICAgICAgZGl2ID0gZWxlbSBjbGFzczogY2xzc1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCBkaXZcbiAgICAgICAgICAgIGNvbXB1dGVkU3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSBkaXZcbiAgICAgICAgICAgIGNvbG9yID0gY29tcHV0ZWRTdHlsZS5jb2xvclxuICAgICAgICAgICAgb3BhY2l0eSA9IGNvbXB1dGVkU3R5bGUub3BhY2l0eVxuICAgICAgICAgICAgaWYgb3BhY2l0eSAhPSAnMSdcbiAgICAgICAgICAgICAgICBjb2xvciA9ICdyZ2JhKCcgKyBjb2xvci5zbGljZSg0LCBjb2xvci5sZW5ndGgtMikgKyAnLCAnICsgb3BhY2l0eSArICcpJ1xuICAgICAgICAgICAgQGNvbG9yc1tjbHNzXSA9IGNvbG9yXG4gICAgICAgICAgICBkaXYucmVtb3ZlKClcblxuICAgICAgICByZXR1cm4gQGNvbG9yc1tjbHNzXVxuXG4gICAgY29sb3JGb3JTdHlsZTogKHN0eWwpIC0+XG5cbiAgICAgICAgaWYgbm90IEBjb2xvcnNbc3R5bF0/XG4gICAgICAgICAgICBkaXYgPSBlbGVtICdkaXYnXG4gICAgICAgICAgICBkaXYuc3R5bGUgPSBzdHlsXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkIGRpdlxuICAgICAgICAgICAgQGNvbG9yc1tzdHlsXSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGRpdikuY29sb3JcbiAgICAgICAgICAgIGRpdi5yZW1vdmUoKVxuICAgICAgICAgICAgXG4gICAgICAgIHJldHVybiBAY29sb3JzW3N0eWxdXG5cbiAgICBzY2hlbWVDaGFuZ2VkOiAtPiBAY29sb3JzID0ge31cblxuICAgICMjI1xuICAgICAwMDAwMDAwICAwMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAgICAwMDAwMDAwXG4gICAgMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgMDAwXG4gICAgMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwMDAwMDAwICAgICAwMDAgICAgIDAwMCAgMDAwXG4gICAgICAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgMDAwXG4gICAgMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMDAwMDBcbiAgICAjIyNcblxuICAgIEBtYXRjaHJDb25maWdzID0ge31cbiAgICBAc3ludGF4TmFtZXMgPSBbXVxuXG4gICAgQHNwYW5Gb3JUZXh0OiAodGV4dCkgLT4gQHNwYW5Gb3JUZXh0QW5kU3ludGF4IHRleHQsICdrbydcbiAgICBAc3BhbkZvclRleHRBbmRTeW50YXg6ICh0ZXh0LCBuKSAtPlxuXG4gICAgICAgIGwgPSBcIlwiXG4gICAgICAgIGRpc3MgPSBAZGlzc0ZvclRleHRBbmRTeW50YXggdGV4dCwgblxuICAgICAgICBpZiBkaXNzPy5sZW5ndGhcbiAgICAgICAgICAgIGxhc3QgPSAwXG4gICAgICAgICAgICBmb3IgZGkgaW4gWzAuLi5kaXNzLmxlbmd0aF1cbiAgICAgICAgICAgICAgICBkID0gZGlzc1tkaV1cbiAgICAgICAgICAgICAgICBzdHlsZSA9IGQuc3R5bD8gYW5kIGQuc3R5bC5sZW5ndGggYW5kIFwiIHN0eWxlPVxcXCIje2Quc3R5bH1cXFwiXCIgb3IgJydcbiAgICAgICAgICAgICAgICBzcGMgPSAnJ1xuICAgICAgICAgICAgICAgIGZvciBzcCBpbiBbbGFzdC4uLmQuc3RhcnRdXG4gICAgICAgICAgICAgICAgICAgIHNwYyArPSAnJm5ic3A7J1xuICAgICAgICAgICAgICAgIGxhc3QgID0gZC5zdGFydCArIGQubWF0Y2gubGVuZ3RoXG4gICAgICAgICAgICAgICAgY2xzcyA9IGQuY2xzcz8gYW5kIGQuY2xzcy5sZW5ndGggYW5kIFwiIGNsYXNzPVxcXCIje2QuY2xzc31cXFwiXCIgb3IgJydcbiAgICAgICAgICAgICAgICBjbHJ6ZCA9IFwiPHNwYW4je3N0eWxlfSN7Y2xzc30+I3tzcGN9I3trc3RyLmVuY29kZSBkLm1hdGNofTwvc3Bhbj5cIlxuICAgICAgICAgICAgICAgIGwgKz0gY2xyemRcbiAgICAgICAgbFxuXG4gICAgQHJhbmdlc0ZvclRleHRBbmRTeW50YXg6IChsaW5lLCBuKSAtPlxuXG4gICAgICAgIG1hdGNoci5yYW5nZXMgU3ludGF4Lm1hdGNockNvbmZpZ3Nbbl0sIGxpbmVcblxuICAgIEBkaXNzRm9yVGV4dEFuZFN5bnRheDogKHRleHQsIG4pIC0+XG5cbiAgICAgICAgaWYgbiBub3QgaW4gWydicm93c2VyJyAna28nICdjb21tYW5kbGluZScgJ21hY3JvJyAndGVybScgJ3Rlc3QnXVxuICAgICAgICAgICAgcmVzdWx0ID0ga2xvci5yYW5nZXMgdGV4dCwgblxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBpZiBub3Qgbj8gb3Igbm90IFN5bnRheC5tYXRjaHJDb25maWdzW25dP1xuICAgICAgICAgICAgICAgIHJldHVybiBrZXJyb3IgXCJubyBzeW50YXg/ICN7bn1cIlxuICAgICAgICAgICAgcmVzdWx0ID0gbWF0Y2hyLmRpc3NlY3QgbWF0Y2hyLnJhbmdlcyBTeW50YXgubWF0Y2hyQ29uZmlnc1tuXSwgdGV4dFxuICAgICAgICByZXN1bHRcblxuICAgIEBsaW5lRm9yRGlzczogKGRzcykgLT5cblxuICAgICAgICBsID0gXCJcIlxuICAgICAgICBmb3IgZCBpbiBkc3NcbiAgICAgICAgICAgIGwgPSBfLnBhZEVuZCBsLCBkLnN0YXJ0XG4gICAgICAgICAgICBsICs9IGQubWF0Y2hcbiAgICAgICAgbFxuXG4gICAgIyAgMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwMDAwMCAgICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgIDAwMDAwMDBcbiAgICAjIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMCAgMDAwICAwMDBcbiAgICAjIDAwMDAwMDAgICAwMDAwMDAwMDAgIDAwMDAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAwMCAgMDAwIDAgMDAwICAwMDAgIDAwMDBcbiAgICAjICAgICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDAgICAwMDBcbiAgICAjIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAwMDAwICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMFxuXG4gICAgQHNoZWJhbmc6IChsaW5lKSAtPlxuXG4gICAgICAgIGlmIGxpbmUuc3RhcnRzV2l0aCBcIiMhXCJcbiAgICAgICAgICAgIGxhc3RXb3JkID0gXy5sYXN0IGxpbmUuc3BsaXQgL1tcXHNcXC9dL1xuICAgICAgICAgICAgc3dpdGNoIGxhc3RXb3JkXG4gICAgICAgICAgICAgICAgd2hlbiAncHl0aG9uJyB0aGVuIHJldHVybiAncHknXG4gICAgICAgICAgICAgICAgd2hlbiAnbm9kZScgICB0aGVuIHJldHVybiAnanMnXG4gICAgICAgICAgICAgICAgd2hlbiAnYmFzaCcgICB0aGVuIHJldHVybiAnc2gnXG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBpZiBsYXN0V29yZCBpbiBAc3ludGF4TmFtZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsYXN0V29yZFxuICAgICAgICAndHh0J1xuXG4gICAgIyAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwMDAwMDBcbiAgICAjIDAwMCAgMDAwMCAgMDAwICAwMDAgICAgIDAwMFxuICAgICMgMDAwICAwMDAgMCAwMDAgIDAwMCAgICAgMDAwXG4gICAgIyAwMDAgIDAwMCAgMDAwMCAgMDAwICAgICAwMDBcbiAgICAjIDAwMCAgMDAwICAgMDAwICAwMDAgICAgIDAwMFxuXG4gICAgQGluaXQ6IC0+XG5cbiAgICAgICAgc3ludGF4RGlyID0gXCIje19fZGlybmFtZX0vLi4vLi4vc3ludGF4L1wiXG5cbiAgICAgICAgZm9yIHN5bnRheEZpbGUgaW4gZnMucmVhZGRpclN5bmMgc3ludGF4RGlyXG5cbiAgICAgICAgICAgIHN5bnRheE5hbWUgPSBzbGFzaC5iYXNlbmFtZSBzeW50YXhGaWxlLCAnLm5vb24nXG4gICAgICAgICAgICBwYXR0ZXJucyA9IG5vb24ubG9hZCBzbGFzaC5qb2luIHN5bnRheERpciwgc3ludGF4RmlsZVxuXG4gICAgICAgICAgICBwYXR0ZXJuc1snXFxcXHcrJ10gICAgICAgPSAndGV4dCcgICAjIHRoaXMgZW5zdXJlcyB0aGF0IGFsbCAuLi5cbiAgICAgICAgICAgIHBhdHRlcm5zWydbXlxcXFx3XFxcXHNdKyddID0gJ3N5bnRheCcgIyBub24tc3BhY2UgY2hhcmFjdGVycyBtYXRjaFxuXG4gICAgICAgICAgICBpZiBwYXR0ZXJucy5rbz8uZXh0bmFtZXM/XG4gICAgICAgICAgICAgICAgZXh0bmFtZXMgPSBwYXR0ZXJucy5rby5leHRuYW1lc1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBwYXR0ZXJucy5rb1xuXG4gICAgICAgICAgICAgICAgY29uZmlnID0gbWF0Y2hyLmNvbmZpZyBwYXR0ZXJuc1xuICAgICAgICAgICAgICAgIGZvciBzeW50YXhOYW1lIGluIGV4dG5hbWVzXG4gICAgICAgICAgICAgICAgICAgIEBzeW50YXhOYW1lcy5wdXNoIHN5bnRheE5hbWVcbiAgICAgICAgICAgICAgICAgICAgQG1hdGNockNvbmZpZ3Nbc3ludGF4TmFtZV0gPSBjb25maWdcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBAc3ludGF4TmFtZXMucHVzaCBzeW50YXhOYW1lXG4gICAgICAgICAgICAgICAgQG1hdGNockNvbmZpZ3Nbc3ludGF4TmFtZV0gPSBtYXRjaHIuY29uZmlnIHBhdHRlcm5zXG5cbiAgICAgICAgIyBrbG9yLmluaXQoKVxuICAgICAgICBAc3ludGF4TmFtZXMgPSBAc3ludGF4TmFtZXMuY29uY2F0IGtsb3IuZXh0c1xuXG5TeW50YXguaW5pdCgpXG5tb2R1bGUuZXhwb3J0cyA9IFN5bnRheFxuIl19
//# sourceURL=../../coffee/editor/syntax.coffee