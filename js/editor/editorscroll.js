// koffee 1.11.0

/*
00000000  0000000    000  000000000   0000000   00000000          0000000   0000000  00000000    0000000   000      000      
000       000   000  000     000     000   000  000   000        000       000       000   000  000   000  000      000      
0000000   000   000  000     000     000   000  0000000          0000000   000       0000000    000   000  000      000      
000       000   000  000     000     000   000  000   000             000  000       000   000  000   000  000      000      
00000000  0000000    000     000      0000000   000   000        0000000    0000000  000   000   0000000   0000000  0000000
 */
var EditorScroll, clamp, events, kxk,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

clamp = require('kxk').clamp;

events = require('events');

kxk = require('kxk');

EditorScroll = (function(superClass) {
    extend(EditorScroll, superClass);

    function EditorScroll(editor) {
        var ref;
        this.editor = editor;
        this.setLineHeight = bind(this.setLineHeight, this);
        this.setNumLines = bind(this.setNumLines, this);
        this.setViewHeight = bind(this.setViewHeight, this);
        this.reset = bind(this.reset, this);
        this.setTop = bind(this.setTop, this);
        this.by = bind(this.by, this);
        this.to = bind(this.to, this);
        this.start = bind(this.start, this);
        EditorScroll.__super__.constructor.call(this);
        this.lineHeight = (ref = this.editor.size.lineHeight) != null ? ref : 0;
        this.viewHeight = -1;
        this.init();
    }

    EditorScroll.prototype.init = function() {
        this.scroll = 0;
        this.offsetTop = 0;
        this.offsetSmooth = 0;
        this.viewHeight = -1;
        this.fullHeight = -1;
        this.fullLines = -1;
        this.viewLines = -1;
        this.scrollMax = -1;
        this.numLines = -1;
        this.top = -1;
        return this.bot = -1;
    };

    EditorScroll.prototype.start = function(viewHeight, numLines) {
        this.viewHeight = viewHeight;
        this.numLines = numLines;
        this.fullHeight = this.numLines * this.lineHeight;
        this.top = 0;
        this.bot = this.top - 1;
        this.calc();
        return this.by(0);
    };

    EditorScroll.prototype.calc = function() {
        if (this.viewHeight <= 0) {
            return;
        }
        this.scrollMax = Math.max(0, this.fullHeight - this.viewHeight);
        this.fullLines = Math.floor(this.viewHeight / this.lineHeight);
        return this.viewLines = Math.ceil(this.viewHeight / this.lineHeight) + 1;
    };

    EditorScroll.prototype.to = function(p) {
        return this.by(p - this.scroll);
    };

    EditorScroll.prototype.by = function(delta, x) {
        var offset, scroll, top;
        if (this.viewLines < 0) {
            return;
        }
        if (x) {
            this.editor.layerScroll.scrollLeft += x;
        }
        if (!delta && this.top < this.bot) {
            return;
        }
        scroll = this.scroll;
        if (Number.isNaN(delta)) {
            delta = 0;
        }
        this.scroll = parseInt(clamp(0, this.scrollMax, this.scroll + delta));
        top = parseInt(this.scroll / this.lineHeight);
        this.offsetSmooth = this.scroll - top * this.lineHeight;
        this.setTop(top);
        offset = 0;
        offset += this.offsetSmooth;
        offset += (top - this.top) * this.lineHeight;
        if (offset !== this.offsetTop || scroll !== this.scroll) {
            this.offsetTop = parseInt(offset);
            this.updateOffset();
            return this.emit('scroll', this.scroll, this.offsetTop);
        }
    };

    EditorScroll.prototype.setTop = function(top) {
        var num, oldBot, oldTop;
        oldTop = this.top;
        oldBot = this.bot;
        this.bot = Math.min(top + this.viewLines, this.numLines - 1);
        this.top = Math.max(0, this.bot - this.viewLines);
        if (oldTop === this.top && oldBot === this.bot) {
            return;
        }
        if ((this.top > oldBot) || (this.bot < oldTop) || (oldBot < oldTop)) {
            num = this.bot - this.top + 1;
            if (num > 0) {
                return this.emit('showLines', this.top, this.bot, num);
            }
        } else {
            num = this.top - oldTop;
            if (0 < Math.abs(num)) {
                return this.emit('shiftLines', this.top, this.bot, num);
            }
        }
    };

    EditorScroll.prototype.lineIndexIsInView = function(li) {
        return (this.top <= li && li <= this.bot);
    };

    EditorScroll.prototype.reset = function() {
        this.emit('clearLines');
        this.init();
        return this.updateOffset();
    };

    EditorScroll.prototype.setViewHeight = function(h) {
        if (this.viewHeight !== h) {
            this.bot = this.top - 1;
            this.viewHeight = h;
            this.calc();
            return this.by(0);
        }
    };

    EditorScroll.prototype.setNumLines = function(n, opt) {
        if (this.numLines !== n) {
            this.fullHeight = n * this.lineHeight;
            if (n) {
                if ((opt != null ? opt.showLines : void 0) !== false) {
                    this.bot = this.top - 1;
                }
                this.numLines = n;
                this.calc();
                return this.by(0);
            } else {
                this.init();
                return this.emit('clearLines');
            }
        }
    };

    EditorScroll.prototype.setLineHeight = function(h) {
        if (this.lineHeight !== h) {
            this.lineHeight = h;
            this.fullHeight = this.numLines * this.lineHeight;
            this.calc();
            return this.by(0);
        }
    };

    EditorScroll.prototype.updateOffset = function() {
        return this.editor.layers.style.transform = "translate3d(0,-" + this.offsetTop + "px, 0)";
    };

    EditorScroll.prototype.cursorToTop = function(topDist) {
        var cp, hl, rg, sl;
        if (topDist == null) {
            topDist = 7;
        }
        cp = this.editor.cursorPos();
        if (cp[1] - this.top > topDist) {
            rg = [this.top, Math.max(0, cp[1] - 1)];
            sl = this.editor.selectionsInLineIndexRange(rg);
            hl = this.editor.highlightsInLineIndexRange(rg);
            if ((sl.length === 0 && 0 === hl.length)) {
                return this.by(this.lineHeight * (cp[1] - this.top - topDist));
            }
        }
    };

    EditorScroll.prototype.cursorIntoView = function() {
        var delta;
        if (delta = this.deltaToEnsureMainCursorIsVisible()) {
            this.by(delta * this.lineHeight - this.offsetSmooth);
        }
        return this.updateCursorOffset();
    };

    EditorScroll.prototype.deltaToEnsureMainCursorIsVisible = function() {
        var cl, maindelta, offset, ref, ref1;
        maindelta = 0;
        cl = this.editor.mainCursor()[1];
        offset = (ref = (ref1 = this.editor.config) != null ? ref1.scrollOffset : void 0) != null ? ref : 2;
        if (cl < this.top + offset + this.offsetTop / this.lineHeight) {
            maindelta = cl - (this.top + offset + this.offsetTop / this.lineHeight);
        } else if (cl > this.top + this.fullLines - offset - 1) {
            maindelta = cl - (this.top + this.fullLines - offset - 1);
        }
        return maindelta;
    };

    EditorScroll.prototype.updateCursorOffset = function() {
        var charWidth, cx, layersWidth, offsetX, scrollLeft;
        offsetX = this.editor.size.offsetX;
        charWidth = this.editor.size.charWidth;
        layersWidth = this.editor.layersWidth;
        scrollLeft = this.editor.layerScroll.scrollLeft;
        cx = this.editor.mainCursor()[0] * charWidth + offsetX;
        if (cx - scrollLeft > layersWidth) {
            return this.editor.layerScroll.scrollLeft = Math.max(0, cx - layersWidth + charWidth);
        } else if (cx - offsetX - scrollLeft < 0) {
            return this.editor.layerScroll.scrollLeft = Math.max(0, cx - offsetX);
        }
    };

    EditorScroll.prototype.info = function() {
        return {
            topbot: this.top + " .. " + this.bot + " = " + (this.bot - this.top) + " / " + this.numLines + " lines",
            scroll: this.scroll + " offsetTop " + this.offsetTop + " viewHeight " + this.viewHeight + " scrollMax " + this.scrollMax + " fullLines " + this.fullLines + " viewLines " + this.viewLines
        };
    };

    return EditorScroll;

})(events);

module.exports = EditorScroll;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWRpdG9yc2Nyb2xsLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uL2NvZmZlZS9lZGl0b3IiLCJzb3VyY2VzIjpbImVkaXRvcnNjcm9sbC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7OztBQUFBLElBQUEsZ0NBQUE7SUFBQTs7OztBQVFFLFFBQVUsT0FBQSxDQUFRLEtBQVI7O0FBRVosTUFBQSxHQUFTLE9BQUEsQ0FBUSxRQUFSOztBQUNULEdBQUEsR0FBUyxPQUFBLENBQVEsS0FBUjs7QUFFSDs7O0lBRUMsc0JBQUMsTUFBRDtBQUVDLFlBQUE7UUFGQSxJQUFDLENBQUEsU0FBRDs7Ozs7Ozs7O1FBRUEsNENBQUE7UUFDQSxJQUFDLENBQUEsVUFBRCx1REFBd0M7UUFDeEMsSUFBQyxDQUFBLFVBQUQsR0FBYyxDQUFDO1FBQ2YsSUFBQyxDQUFBLElBQUQsQ0FBQTtJQUxEOzsyQkFhSCxJQUFBLEdBQU0sU0FBQTtRQUVGLElBQUMsQ0FBQSxNQUFELEdBQWlCO1FBQ2pCLElBQUMsQ0FBQSxTQUFELEdBQWlCO1FBQ2pCLElBQUMsQ0FBQSxZQUFELEdBQWlCO1FBRWpCLElBQUMsQ0FBQSxVQUFELEdBQWdCLENBQUM7UUFDakIsSUFBQyxDQUFBLFVBQUQsR0FBZ0IsQ0FBQztRQUNqQixJQUFDLENBQUEsU0FBRCxHQUFnQixDQUFDO1FBQ2pCLElBQUMsQ0FBQSxTQUFELEdBQWdCLENBQUM7UUFDakIsSUFBQyxDQUFBLFNBQUQsR0FBZ0IsQ0FBQztRQUNqQixJQUFDLENBQUEsUUFBRCxHQUFnQixDQUFDO1FBQ2pCLElBQUMsQ0FBQSxHQUFELEdBQWdCLENBQUM7ZUFDakIsSUFBQyxDQUFBLEdBQUQsR0FBZ0IsQ0FBQztJQWJmOzsyQkFlTixLQUFBLEdBQU8sU0FBQyxVQUFELEVBQWMsUUFBZDtRQUFDLElBQUMsQ0FBQSxhQUFEO1FBQWEsSUFBQyxDQUFBLFdBQUQ7UUFFakIsSUFBQyxDQUFBLFVBQUQsR0FBYyxJQUFDLENBQUEsUUFBRCxHQUFZ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R0FBTSxNQUFOLEdBQVksSUFBQyxDQUFBLEdBQWIsR0FBaUIsS0FBakIsR0FBcUIsQ0FBQyxJQUFDLENBQUEsR0FBRCxHQUFLLElBQUMsQ0FBQSxHQUFQLENBQXJCLEdBQWdDLEtBQWhDLEdBQXFDLElBQUMsQ0FBQSxRQUF0QyxHQUErQyxRQUF6RDtZQUNBLE1BQUEsRUFBVyxJQUFDLENBQUEsTUFBRixHQUFTLGFBQVQsR0FBc0IsSUFBQyxDQUFBLFNBQXZCLEdBQWlDLGNBQWpDLEdBQStDLElBQUMsQ0FBQSxVQUFoRCxHQUEyRCxhQUEzRCxHQUF3RSxJQUFDLENBQUEsU0FBekUsR0FBbUYsYUFBbkYsR0FBZ0csSUFBQyxDQUFBLFNBQWpHLEdBQTJHLGFBQTNHLEdBQXdILElBQUMsQ0FBQSxTQURuSTs7SUFGRTs7OztHQTdQaUI7O0FBa1EzQixNQUFNLENBQUMsT0FBUCxHQUFpQiIsInNvdXJjZXNDb250ZW50IjpbIiMjI1xuMDAwMDAwMDAgIDAwMDAwMDAgICAgMDAwICAwMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgICAgICAgICAgMDAwMDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAgICAgICAwMDAgICAgICBcbjAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgICAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgICAgXG4wMDAwMDAwICAgMDAwICAgMDAwICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAwMDAwICAgICAgICAgIDAwMDAwMDAgICAwMDAgICAgICAgMDAwMDAwMCAgICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgICAgIFxuMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAgICAgICAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAgICBcbjAwMDAwMDAwICAwMDAwMDAwICAgIDAwMCAgICAgMDAwICAgICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgICAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgMDAwMDAwMCAgXG4jIyNcblxueyBjbGFtcCB9ID0gcmVxdWlyZSAna3hrJ1xuXG5ldmVudHMgPSByZXF1aXJlICdldmVudHMnXG5reGsgICAgPSByZXF1aXJlICdreGsnXG5cbmNsYXNzIEVkaXRvclNjcm9sbCBleHRlbmRzIGV2ZW50c1xuXG4gICAgQDogKEBlZGl0b3IpIC0+XG5cbiAgICAgICAgc3VwZXIoKVxuICAgICAgICBAbGluZUhlaWdodCA9IEBlZGl0b3Iuc2l6ZS5saW5lSGVpZ2h0ID8gMFxuICAgICAgICBAdmlld0hlaWdodCA9IC0xXG4gICAgICAgIEBpbml0KClcbiAgICAgICAgXG4gICAgIyAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwMDAwMDBcbiAgICAjIDAwMCAgMDAwMCAgMDAwICAwMDAgICAgIDAwMCAgIFxuICAgICMgMDAwICAwMDAgMCAwMDAgIDAwMCAgICAgMDAwICAgXG4gICAgIyAwMDAgIDAwMCAgMDAwMCAgMDAwICAgICAwMDAgICBcbiAgICAjIDAwMCAgMDAwICAgMDAwICAwMDAgICAgIDAwMCAgIFxuXG4gICAgaW5pdDogLT5cbiAgICAgICAgXG4gICAgICAgIEBzY3JvbGwgICAgICAgPSAgMCAjIGN1cnJlbnQgc2Nyb2xsIHZhbHVlIGZyb20gZG9jdW1lbnQgc3RhcnQgKHBpeGVscylcbiAgICAgICAgQG9mZnNldFRvcCAgICA9ICAwICMgaGVpZ2h0IG9mIHZpZXcgYWJvdmUgZmlyc3QgdmlzaWJsZSBsaW5lIChwaXhlbHMpXG4gICAgICAgIEBvZmZzZXRTbW9vdGggPSAgMCAjIHNtb290aCBzY3JvbGxpbmcgb2Zmc2V0IC8gcGFydCBvZiB0b3AgbGluZSB0aGF0IGlzIGhpZGRlbiAocGl4ZWxzKVxuICAgICAgICBcbiAgICAgICAgQHZpZXdIZWlnaHQgICA9IC0xXG4gICAgICAgIEBmdWxsSGVpZ2h0ICAgPSAtMSAjIHRvdGFsIGhlaWdodCBvZiBidWZmZXIgKHBpeGVscylcbiAgICAgICAgQGZ1bGxMaW5lcyAgICA9IC0xICMgbnVtYmVyIG9mIGZ1bGwgbGluZXMgZml0dGluZyBpbiB2aWV3IChleGNsdWRpbmcgcGFydGlhbHMpXG4gICAgICAgIEB2aWV3TGluZXMgICAgPSAtMSAjIG51bWJlciBvZiBsaW5lcyBmaXR0aW5nIGluIHZpZXcgKGluY2x1ZGluZyBwYXJ0aWFscylcbiAgICAgICAgQHNjcm9sbE1heCAgICA9IC0xICMgbWF4aW11bSBzY3JvbGwgb2Zmc2V0IChwaXhlbHMpXG4gICAgICAgIEBudW1MaW5lcyAgICAgPSAtMSAjIHRvdGFsIG51bWJlciBvZiBsaW5lcyBpbiBidWZmZXJcbiAgICAgICAgQHRvcCAgICAgICAgICA9IC0xICMgaW5kZXggb2YgZmlyc3QgdmlzaWJsZSBsaW5lIGluIHZpZXdcbiAgICAgICAgQGJvdCAgICAgICAgICA9IC0xICMgaW5kZXggb2YgbGFzdCAgdmlzaWJsZSBsaW5lIGluIHZpZXdcblxuICAgIHN0YXJ0OiAoQHZpZXdIZWlnaHQsIEBudW1MaW5lcykgPT5cbiAgICAgICAgXG4gICAgICAgIEBmdWxsSGVpZ2h0ID0gQG51bUxpbmVzICogQGxpbmVIZWlnaHRcbiAgICAgICAgQHRvcCA9IDBcbiAgICAgICAgQGJvdCA9IEB0b3AtMVxuICAgICAgICBAY2FsYygpXG4gICAgICAgIEBieSAwXG5cbiAgICAjICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAgICAgICAwMDAwMDAwICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgICAgICBcbiAgICAjIDAwMCAgICAgICAwMDAwMDAwMDAgIDAwMCAgICAgIDAwMCAgICAgICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgICAgICBcbiAgICAjICAwMDAwMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgICAwMDAwMDAwICBcbiAgICBcbiAgICBjYWxjOiAtPlxuICAgICAgICBcbiAgICAgICAgaWYgQHZpZXdIZWlnaHQgPD0gMFxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICBcbiAgICAgICAgQHNjcm9sbE1heCA9IE1hdGgubWF4KDAsQGZ1bGxIZWlnaHQgLSBAdmlld0hlaWdodCkgICAjIG1heGltdW0gc2Nyb2xsIG9mZnNldCAocGl4ZWxzKVxuICAgICAgICBAZnVsbExpbmVzID0gTWF0aC5mbG9vcihAdmlld0hlaWdodCAvIEBsaW5lSGVpZ2h0KSAgICMgbnVtYmVyIG9mIGxpbmVzIGluIHZpZXcgKGV4Y2x1ZGluZyBwYXJ0aWFscylcbiAgICAgICAgQHZpZXdMaW5lcyA9IE1hdGguY2VpbChAdmlld0hlaWdodCAvIEBsaW5lSGVpZ2h0KSsxICAjIG51bWJlciBvZiBsaW5lcyBpbiB2aWV3IChpbmNsdWRpbmcgcGFydGlhbHMpXG4gICAgICAgIFxuICAgICMgMDAwMDAwMCAgICAwMDAgICAwMDBcbiAgICAjIDAwMCAgIDAwMCAgIDAwMCAwMDAgXG4gICAgIyAwMDAwMDAwICAgICAgMDAwMDAgIFxuICAgICMgMDAwICAgMDAwICAgICAwMDAgICBcbiAgICAjIDAwMDAwMDAgICAgICAgMDAwICAgXG4gICAgICAgIFxuICAgIHRvOiAocCkgPT4gQGJ5IHAtQHNjcm9sbFxuICAgIFxuICAgIGJ5OiAoZGVsdGEsIHgpID0+XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gaWYgQHZpZXdMaW5lcyA8IDBcbiAgICAgICAgXG4gICAgICAgIEBlZGl0b3IubGF5ZXJTY3JvbGwuc2Nyb2xsTGVmdCArPSB4IGlmIHhcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBpZiBub3QgZGVsdGEgYW5kIEB0b3AgPCBAYm90XG4gICAgICAgIFxuICAgICAgICBzY3JvbGwgPSBAc2Nyb2xsXG4gICAgICAgIGRlbHRhID0gMCBpZiBOdW1iZXIuaXNOYU4gZGVsdGFcbiAgICAgICAgQHNjcm9sbCA9IHBhcnNlSW50IGNsYW1wIDAsIEBzY3JvbGxNYXgsIEBzY3JvbGwrZGVsdGFcbiAgICAgICAgdG9wID0gcGFyc2VJbnQgQHNjcm9sbCAvIEBsaW5lSGVpZ2h0XG4gICAgICAgIEBvZmZzZXRTbW9vdGggPSBAc2Nyb2xsIC0gdG9wICogQGxpbmVIZWlnaHQgXG4gICAgICAgIFxuICAgICAgICBAc2V0VG9wIHRvcFxuXG4gICAgICAgIG9mZnNldCA9IDBcbiAgICAgICAgb2Zmc2V0ICs9IEBvZmZzZXRTbW9vdGhcbiAgICAgICAgb2Zmc2V0ICs9ICh0b3AgLSBAdG9wKSAqIEBsaW5lSGVpZ2h0XG4gICAgICAgIFxuICAgICAgICBpZiBvZmZzZXQgIT0gQG9mZnNldFRvcCBvciBzY3JvbGwgIT0gQHNjcm9sbFxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBAb2Zmc2V0VG9wID0gcGFyc2VJbnQgb2Zmc2V0XG4gICAgICAgICAgICBAdXBkYXRlT2Zmc2V0KClcbiAgICAgICAgICAgIEBlbWl0ICdzY3JvbGwnIEBzY3JvbGwsIEBvZmZzZXRUb3BcbiAgICAgICAgICAgIFxuICAgICMgIDAwMDAwMDAgIDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAgICAgMDAwICAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwXG4gICAgIyAwMDAwMDAwICAgMDAwMDAwMCAgICAgIDAwMCAgICAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMDAwMDAwIFxuICAgICMgICAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAgICBcbiAgICAjIDAwMDAwMDAgICAwMDAwMDAwMCAgICAgMDAwICAgICAgICAwMDAgICAgICAwMDAwMDAwICAgMDAwICAgICAgXG4gICAgICAgICAgICBcbiAgICBzZXRUb3A6ICh0b3ApID0+XG4gICAgICAgIFxuICAgICAgICBvbGRUb3AgPSBAdG9wXG4gICAgICAgIG9sZEJvdCA9IEBib3RcbiAgICAgICAgXG4gICAgICAgIEBib3QgPSBNYXRoLm1pbiB0b3ArQHZpZXdMaW5lcywgQG51bUxpbmVzLTFcbiAgICAgICAgQHRvcCA9IE1hdGgubWF4IDAsIEBib3QgLSBAdmlld0xpbmVzXG5cbiAgICAgICAgcmV0dXJuIGlmIG9sZFRvcCA9PSBAdG9wIGFuZCBvbGRCb3QgPT0gQGJvdFxuICAgICAgICAgICAgXG4gICAgICAgIGlmIChAdG9wID4gb2xkQm90KSBvciAoQGJvdCA8IG9sZFRvcCkgb3IgKG9sZEJvdCA8IG9sZFRvcCkgXG4gICAgICAgICAgICAjIG5ldyByYW5nZSBvdXRzaWRlLCBzdGFydCBmcm9tIHNjcmF0Y2hcbiAgICAgICAgICAgIG51bSA9IEBib3QgLSBAdG9wICsgMVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiBudW0gPiAwXG4gICAgICAgICAgICAgICAgQGVtaXQgJ3Nob3dMaW5lcycgQHRvcCwgQGJvdCwgbnVtXG5cbiAgICAgICAgZWxzZSAgIFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBudW0gPSBAdG9wIC0gb2xkVG9wXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIDAgPCBNYXRoLmFicyBudW1cbiAgICAgICAgICAgICAgICBAZW1pdCAnc2hpZnRMaW5lcycgQHRvcCwgQGJvdCwgbnVtXG4gICAgICAgICAgICAgICAgXG4gICAgbGluZUluZGV4SXNJblZpZXc6IChsaSkgLT4gQHRvcCA8PSBsaSA8PSBAYm90XG4gICAgXG4gICAgIyAwMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwMDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIDAwMCAgICAgICAgICAwMDAgICBcbiAgICAjIDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwICAgICAgMDAwICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAgICAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgIFxuICAgICMgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAwICAgICAwMDAgICBcbiAgICBcbiAgICByZXNldDogPT5cbiAgICAgICAgXG4gICAgICAgIEBlbWl0ICdjbGVhckxpbmVzJ1xuICAgICAgICBAaW5pdCgpXG4gICAgICAgIEB1cGRhdGVPZmZzZXQoKVxuICAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAwMDAgICAgICAgMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgIDAwMCAgICAgICAgMDAwICAgMDAwICAgICAwMDAgICBcbiAgICAjICAwMDAgMDAwICAgMDAwICAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAgICAwMDAgIDAwMCAgMDAwMCAgMDAwMDAwMDAwICAgICAwMDAgICBcbiAgICAjICAgIDAwMCAgICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICBcbiAgICAjICAgICAwICAgICAgMDAwICAwMDAwMDAwMCAgMDAgICAgIDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgICAwMDAgICBcblxuICAgIHNldFZpZXdIZWlnaHQ6IChoKSA9PlxuICAgICAgICBcbiAgICAgICAgaWYgQHZpZXdIZWlnaHQgIT0gaFxuICAgICAgICAgICAgQGJvdCA9IEB0b3AtMSAjIGFsd2F5cyBlbWl0IHNob3dMaW5lcyBpZiBoZWlnaHQgY2hhbmdlc1xuICAgICAgICAgICAgQHZpZXdIZWlnaHQgPSBoXG4gICAgICAgICAgICBAY2FsYygpXG4gICAgICAgICAgICBAYnkgMFxuICAgICAgICAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAgICAgIDAwICAwMDAgICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwXG4gICAgIyAwMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgXG4gICAgIyAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwICAwMDAgICAgICAwMDAgIDAwMCAwIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgXG4gICAgIyAwMDAgIDAwMDAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwICAwMDAgICAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgICAgICAgICAgMDAwXG4gICAgIyAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAgXG4gICAgICAgIFxuICAgIHNldE51bUxpbmVzOiAobiwgb3B0KSA9PlxuICAgICAgICBcbiAgICAgICAgaWYgQG51bUxpbmVzICE9IG5cbiAgICAgICAgICAgIEBmdWxsSGVpZ2h0ID0gbiAqIEBsaW5lSGVpZ2h0XG4gICAgICAgICAgICBpZiBuXG4gICAgICAgICAgICAgICAgaWYgb3B0Py5zaG93TGluZXMgIT0gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgQGJvdCA9IEB0b3AtMSAjIGFsd2F5cyBlbWl0IHNob3dMaW5lcyBpZiBsaW5lIG51bWJlciBjaGFuZ2VzXG4gICAgICAgICAgICAgICAgQG51bUxpbmVzID0gblxuICAgICAgICAgICAgICAgIEBjYWxjKClcbiAgICAgICAgICAgICAgICBAYnkgMFxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIEBpbml0KClcbiAgICAgICAgICAgICAgICBAZW1pdCAnY2xlYXJMaW5lcycgICAgICAgICAgICAgXG5cbiAgICAjIDAwMCAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwXG4gICAgIyAwMDAgICAgICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgMDAwICAgICAgICAwMDAgICAwMDAgICAgIDAwMCAgIFxuICAgICMgMDAwICAgICAgMDAwICAwMDAgMCAwMDAgIDAwMDAwMDAgICAwMDAwMDAwMDAgIDAwMDAwMDAgICAwMDAgIDAwMCAgMDAwMCAgMDAwMDAwMDAwICAgICAwMDAgICBcbiAgICAjIDAwMCAgICAgIDAwMCAgMDAwICAwMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgXG4gICAgIyAwMDAwMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgICAgIDAwMCAgIFxuXG4gICAgc2V0TGluZUhlaWdodDogKGgpID0+XG4gICAgICAgICAgICBcbiAgICAgICAgaWYgQGxpbmVIZWlnaHQgIT0gaFxuICAgICAgICAgICAgQGxpbmVIZWlnaHQgPSBoXG4gICAgICAgICAgICBAZnVsbEhlaWdodCA9IEBudW1MaW5lcyAqIEBsaW5lSGVpZ2h0XG4gICAgICAgICAgICBAY2FsYygpXG4gICAgICAgICAgICBAYnkgMFxuXG4gICAgIyAgMDAwMDAwMCAgIDAwMDAwMDAwICAwMDAwMDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAwICAwMDAwMDAwMDAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAgICAgICAgMDAwICAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwMDAwICAgIDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMCAgICAgIDAwMCAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgICAgICAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgIFxuICAgICMgIDAwMDAwMDAgICAwMDAgICAgICAgMDAwICAgICAgIDAwMDAwMDAgICAwMDAwMDAwMCAgICAgMDAwICAgICBcbiAgICBcbiAgICB1cGRhdGVPZmZzZXQ6IC0+IFxuICAgICAgICAgICAgICAgIFxuICAgICAgICBAZWRpdG9yLmxheWVycy5zdHlsZS50cmFuc2Zvcm0gPSBcInRyYW5zbGF0ZTNkKDAsLSN7QG9mZnNldFRvcH1weCwgMClcIlxuICAgICAgICAgICAgXG4gICAgIyAgMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAgICAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgXG4gICAgIyAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgXG4gICAgICAgICAgICBcbiAgICBjdXJzb3JUb1RvcDogKHRvcERpc3Q9NykgLT5cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgY3AgPSBAZWRpdG9yLmN1cnNvclBvcygpXG4gICAgICAgIFxuICAgICAgICBpZiBjcFsxXSAtIEB0b3AgPiB0b3BEaXN0XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJnID0gW0B0b3AsIE1hdGgubWF4IDAsIGNwWzFdLTFdXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHNsID0gQGVkaXRvci5zZWxlY3Rpb25zSW5MaW5lSW5kZXhSYW5nZSByZ1xuICAgICAgICAgICAgaGwgPSBAZWRpdG9yLmhpZ2hsaWdodHNJbkxpbmVJbmRleFJhbmdlIHJnXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIHNsLmxlbmd0aCA9PSAwID09IGhsLmxlbmd0aFxuICAgICAgICAgICAgICAgIEBieSBAbGluZUhlaWdodCAqIChjcFsxXSAtIEB0b3AgLSB0b3BEaXN0KVxuXG4gICAgY3Vyc29ySW50b1ZpZXc6IC0+XG5cbiAgICAgICAgaWYgZGVsdGEgPSBAZGVsdGFUb0Vuc3VyZU1haW5DdXJzb3JJc1Zpc2libGUoKVxuICAgICAgICAgICAgQGJ5IGRlbHRhICogQGxpbmVIZWlnaHQgLSBAb2Zmc2V0U21vb3RoXG4gICAgICAgICAgICBcbiAgICAgICAgQHVwZGF0ZUN1cnNvck9mZnNldCgpXG5cbiAgICBkZWx0YVRvRW5zdXJlTWFpbkN1cnNvcklzVmlzaWJsZTogLT5cbiAgICAgICAgXG4gICAgICAgIG1haW5kZWx0YSA9IDBcbiAgICAgICAgY2wgPSBAZWRpdG9yLm1haW5DdXJzb3IoKVsxXVxuICAgICAgICBcbiAgICAgICAgb2Zmc2V0ID0gQGVkaXRvci5jb25maWc/LnNjcm9sbE9mZnNldCA/IDJcbiAgICAgICAgXG4gICAgICAgIGlmIGNsIDwgQHRvcCArIG9mZnNldCArIEBvZmZzZXRUb3AgLyBAbGluZUhlaWdodFxuICAgICAgICAgICAgbWFpbmRlbHRhID0gY2wgLSAoQHRvcCArIG9mZnNldCArIEBvZmZzZXRUb3AgLyBAbGluZUhlaWdodClcbiAgICAgICAgZWxzZSBpZiBjbCA+IEB0b3AgKyBAZnVsbExpbmVzIC0gb2Zmc2V0IC0gMVxuICAgICAgICAgICAgbWFpbmRlbHRhID0gY2wgLSAoQHRvcCArIEBmdWxsTGluZXMgLSBvZmZzZXQgLSAxKVxuXG4gICAgICAgIG1haW5kZWx0YVxuICAgICAgICAgICAgXG4gICAgdXBkYXRlQ3Vyc29yT2Zmc2V0OiAtPlxuICAgICAgICBcbiAgICAgICAgb2Zmc2V0WCAgICAgPSBAZWRpdG9yLnNpemUub2Zmc2V0WFxuICAgICAgICBjaGFyV2lkdGggICA9IEBlZGl0b3Iuc2l6ZS5jaGFyV2lkdGhcbiAgICAgICAgbGF5ZXJzV2lkdGggPSBAZWRpdG9yLmxheWVyc1dpZHRoXG4gICAgICAgIHNjcm9sbExlZnQgID0gQGVkaXRvci5sYXllclNjcm9sbC5zY3JvbGxMZWZ0XG5cbiAgICAgICAgY3ggPSBAZWRpdG9yLm1haW5DdXJzb3IoKVswXSpjaGFyV2lkdGgrb2Zmc2V0WFxuICAgICAgICBcbiAgICAgICAgaWYgY3gtc2Nyb2xsTGVmdCA+IGxheWVyc1dpZHRoXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIEBlZGl0b3IubGF5ZXJTY3JvbGwuc2Nyb2xsTGVmdCA9IE1hdGgubWF4IDAsIGN4IC0gbGF5ZXJzV2lkdGggKyBjaGFyV2lkdGhcbiAgICAgICAgICAgIFxuICAgICAgICBlbHNlIGlmIGN4LW9mZnNldFgtc2Nyb2xsTGVmdCA8IDBcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgQGVkaXRvci5sYXllclNjcm9sbC5zY3JvbGxMZWZ0ID0gTWF0aC5tYXggMCwgY3ggLSBvZmZzZXRYXG4gICAgICAgICAgICBcbiAgICAjIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgIDAwMDAwMDAgXG4gICAgIyAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMFxuICAgICMgMDAwICAwMDAgMCAwMDAgIDAwMDAwMCAgICAwMDAgICAwMDBcbiAgICAjIDAwMCAgMDAwICAwMDAwICAwMDAgICAgICAgMDAwICAgMDAwXG4gICAgIyAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAwMDAwMDAwIFxuICAgIFxuICAgIGluZm86IC0+XG4gICAgICAgIFxuICAgICAgICB0b3Bib3Q6IFwiI3tAdG9wfSAuLiAje0Bib3R9ID0gI3tAYm90LUB0b3B9IC8gI3tAbnVtTGluZXN9IGxpbmVzXCJcbiAgICAgICAgc2Nyb2xsOiBcIiN7QHNjcm9sbH0gb2Zmc2V0VG9wICN7QG9mZnNldFRvcH0gdmlld0hlaWdodCAje0B2aWV3SGVpZ2h0fSBzY3JvbGxNYXggI3tAc2Nyb2xsTWF4fSBmdWxsTGluZXMgI3tAZnVsbExpbmVzfSB2aWV3TGluZXMgI3tAdmlld0xpbmVzfVwiXG4gICAgICAgIFxubW9kdWxlLmV4cG9ydHMgPSBFZGl0b3JTY3JvbGxcbiJdfQ==
//# sourceURL=../../coffee/editor/editorscroll.coffee