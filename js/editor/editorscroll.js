// koffee 1.4.0

/*
00000000  0000000    000  000000000   0000000   00000000          0000000   0000000  00000000    0000000   000      000      
000       000   000  000     000     000   000  000   000        000       000       000   000  000   000  000      000      
0000000   000   000  000     000     000   000  0000000          0000000   000       0000000    000   000  000      000      
000       000   000  000     000     000   000  000   000             000  000       000   000  000   000  000      000      
00000000  0000000    000     000      0000000   000   000        0000000    0000000  000   000   0000000   0000000  0000000
 */
var EditorScroll, clamp, events, klog, kxk, ref,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

ref = require('kxk'), clamp = ref.clamp, klog = ref.klog;

events = require('events');

kxk = require('kxk');

EditorScroll = (function(superClass) {
    extend(EditorScroll, superClass);

    function EditorScroll(editor) {
        var ref1;
        this.editor = editor;
        this.setLineHeight = bind(this.setLineHeight, this);
        this.setNumLines = bind(this.setNumLines, this);
        this.setViewHeight = bind(this.setViewHeight, this);
        this.reset = bind(this.reset, this);
        this.setTop = bind(this.setTop, this);
        this.by = bind(this.by, this);
        this.to = bind(this.to, this);
        this.start = bind(this.start, this);
        EditorScroll.__super__.constructor.call(this);
        this.lineHeight = (ref1 = this.editor.size.lineHeight) != null ? ref1 : 0;
        this.viewHeight = -1;
        this.init();
    }

    EditorScroll.prototype.init = function() {
        this.scroll = 0;
        this.offsetTop = 0;
        this.offsetSmooth = 0;
        this.viewHeight = -1;
        this.fullHeight = -1;
        this.fullLines = -1;
        this.viewLines = -1;
        this.scrollMax = -1;
        this.numLines = -1;
        this.top = -1;
        return this.bot = -1;
    };

    EditorScroll.prototype.start = function(viewHeight, numLines) {
        this.viewHeight = viewHeight;
        this.numLines = numLines;
        this.fullHeight = this.numLines * this.lineHeight;
        this.top = 0;
        this.bot = this.top - 1;
        this.calc();
        return this.by(0);
    };

    EditorScroll.prototype.calc = function() {
        if (this.viewHeight <= 0) {
            return;
        }
        this.scrollMax = Math.max(0, this.fullHeight - this.viewHeight);
        this.fullLines = Math.floor(this.viewHeight / this.lineHeight);
        return this.viewLines = Math.ceil(this.viewHeight / this.lineHeight) + 1;
    };

    EditorScroll.prototype.to = function(p) {
        return this.by(p - this.scroll);
    };

    EditorScroll.prototype.by = function(delta, x) {
        var offset, scroll, top;
        if (this.viewLines < 0) {
            return;
        }
        if (x) {
            this.editor.layerScroll.scrollLeft += x;
        }
        if (!delta && this.top < this.bot) {
            return;
        }
        scroll = this.scroll;
        if (Number.isNaN(delta)) {
            delta = 0;
        }
        this.scroll = parseInt(clamp(0, this.scrollMax, this.scroll + delta));
        top = parseInt(this.scroll / this.lineHeight);
        this.offsetSmooth = this.scroll - top * this.lineHeight;
        this.setTop(top);
        offset = 0;
        offset += this.offsetSmooth;
        offset += (top - this.top) * this.lineHeight;
        if (offset !== this.offsetTop || scroll !== this.scroll) {
            this.offsetTop = parseInt(offset);
            this.updateOffset();
            return this.emit('scroll', this.scroll, this.offsetTop);
        }
    };

    EditorScroll.prototype.setTop = function(top) {
        var num, oldBot, oldTop;
        oldTop = this.top;
        oldBot = this.bot;
        this.bot = Math.min(top + this.viewLines, this.numLines - 1);
        this.top = Math.max(0, this.bot - this.viewLines);
        if (oldTop === this.top && oldBot === this.bot) {
            return;
        }
        if ((this.top > oldBot) || (this.bot < oldTop) || (oldBot < oldTop)) {
            num = this.bot - this.top + 1;
            if (num > 0) {
                return this.emit('showLines', this.top, this.bot, num);
            }
        } else {
            num = this.top - oldTop;
            if (0 < Math.abs(num)) {
                return this.emit('shiftLines', this.top, this.bot, num);
            }
        }
    };

    EditorScroll.prototype.lineIndexIsInView = function(li) {
        return (this.top <= li && li <= this.bot);
    };

    EditorScroll.prototype.reset = function() {
        this.emit('clearLines');
        this.init();
        return this.updateOffset();
    };

    EditorScroll.prototype.setViewHeight = function(h) {
        if (this.viewHeight !== h) {
            this.bot = this.top - 1;
            this.viewHeight = h;
            this.calc();
            return this.by(0);
        }
    };

    EditorScroll.prototype.setNumLines = function(n, opt) {
        if (this.numLines !== n) {
            this.fullHeight = n * this.lineHeight;
            if (n) {
                if ((opt != null ? opt.showLines : void 0) !== false) {
                    this.bot = this.top - 1;
                }
                this.numLines = n;
                this.calc();
                return this.by(0);
            } else {
                this.init();
                return this.emit('clearLines');
            }
        }
    };

    EditorScroll.prototype.setLineHeight = function(h) {
        if (this.lineHeight !== h) {
            this.lineHeight = h;
            this.fullHeight = this.numLines * this.lineHeight;
            this.calc();
            return this.by(0);
        }
    };

    EditorScroll.prototype.updateOffset = function() {
        return this.editor.layers.style.transform = "translate3d(0,-" + this.offsetTop + "px, 0)";
    };

    EditorScroll.prototype.cursorToTop = function(topDist) {
        var cp, hl, rg, sl;
        if (topDist == null) {
            topDist = 7;
        }
        cp = this.editor.cursorPos();
        if (cp[1] - this.top > topDist) {
            rg = [this.top, Math.max(0, cp[1] - 1)];
            sl = this.editor.selectionsInLineIndexRange(rg);
            hl = this.editor.highlightsInLineIndexRange(rg);
            if ((sl.length === 0 && 0 === hl.length)) {
                klog('cursorToTop', cp[1] - this.top - topDist);
                return this.by(this.lineHeight * (cp[1] - this.top - topDist));
            }
        }
    };

    EditorScroll.prototype.cursorIntoView = function() {
        var delta;
        if (delta = this.deltaToEnsureMainCursorIsVisible()) {
            this.by(delta * this.lineHeight - this.offsetSmooth);
        }
        return this.updateCursorOffset();
    };

    EditorScroll.prototype.deltaToEnsureMainCursorIsVisible = function() {
        var cl, maindelta, offset, ref1, ref2;
        maindelta = 0;
        cl = this.editor.mainCursor()[1];
        offset = (ref1 = (ref2 = this.editor.config) != null ? ref2.scrollOffset : void 0) != null ? ref1 : 2;
        if (cl < this.top + offset + this.offsetTop / this.lineHeight) {
            maindelta = cl - (this.top + offset + this.offsetTop / this.lineHeight);
        } else if (cl > this.top + this.fullLines - offset - 1) {
            maindelta = cl - (this.top + this.fullLines - offset - 1);
        }
        return maindelta;
    };

    EditorScroll.prototype.updateCursorOffset = function() {
        var charWidth, cx, layersWidth, offsetX, scrollLeft;
        offsetX = this.editor.size.offsetX;
        charWidth = this.editor.size.charWidth;
        layersWidth = this.editor.layersWidth;
        scrollLeft = this.editor.layerScroll.scrollLeft;
        cx = this.editor.mainCursor()[0] * charWidth + offsetX;
        if (cx - scrollLeft > layersWidth) {
            return this.editor.layerScroll.scrollLeft = Math.max(0, cx - layersWidth + charWidth);
        } else if (cx - offsetX - scrollLeft < 0) {
            return this.editor.layerScroll.scrollLeft = Math.max(0, cx - offsetX);
        }
    };

    EditorScroll.prototype.info = function() {
        return {
            topbot: this.top + " .. " + this.bot + " = " + (this.bot - this.top) + " / " + this.numLines + " lines",
            scroll: this.scroll + " offsetTop " + this.offsetTop + " viewHeight " + this.viewHeight + " scrollMax " + this.scrollMax + " fullLines " + this.fullLines + " viewLines " + this.viewLines
        };
    };

    return EditorScroll;

})(events);

module.exports = EditorScroll;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWRpdG9yc2Nyb2xsLmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQSwyQ0FBQTtJQUFBOzs7O0FBUUEsTUFBa0IsT0FBQSxDQUFRLEtBQVIsQ0FBbEIsRUFBRSxpQkFBRixFQUFTOztBQUVULE1BQUEsR0FBUyxPQUFBLENBQVEsUUFBUjs7QUFDVCxHQUFBLEdBQVMsT0FBQSxDQUFRLEtBQVI7O0FBRUg7OztJQUVDLHNCQUFDLE1BQUQ7QUFFQyxZQUFBO1FBRkEsSUFBQyxDQUFBLFNBQUQ7Ozs7Ozs7OztRQUVBLDRDQUFBO1FBQ0EsSUFBQyxDQUFBLFVBQUQseURBQXdDO1FBQ3hDLElBQUMsQ0FBQSxVQUFELEdBQWMsQ0FBQztRQUNmLElBQUMsQ0FBQSxJQUFELENBQUE7SUFMRDs7MkJBYUgsSUFBQSxHQUFNLFNBQUE7UUFFRixJQUFDLENBQUEsTUFBRCxHQUFpQjtRQUNqQixJQUFDLENBQUEsU0FBRCxHQUFpQjtRQUNqQixJQUFDLENBQUEsWUFBRCxHQUFpQjtRQUVqQixJQUFDLENBQUEsVUFBRCxHQUFnQixDQUFDO1FBQ2pCLElBQUMsQ0FBQSxVQUFELEdBQWdCLENBQUM7UUFDakIsSUFBQyxDQUFBLFNBQUQsR0FBZ0IsQ0FBQztRQUNqQixJQUFDLENBQUEsU0FBRCxHQUFnQixDQUFDO1FBQ2pCLElBQUMsQ0FBQSxTQUFELEdBQWdCLENBQUM7UUFDakIsSUFBQyxDQUFBLFFBQUQsR0FBZ0IsQ0FBQztRQUNqQixJQUFDLENBQUEsR0FBRCxHQUFnQixDQUFDO2VBQ2pCLElBQUMsQ0FBQSxHQUFELEdBQWdCLENBQUM7SUFiZjs7MkJBZU4sS0FBQSxHQUFPLFNBQUMsVUFBRCxFQUFjLFFBQWQ7UUFBQyxJQUFDLENBQUEsYUFBRDtRQUFhLElBQUMsQ0FBQSxXQUFEO1FBRWpCLElBQUMsQ0FBQSxVQUFELEdBQWMsSUFBQyxDQUFBLFFBQUQsR0FBWSxJQUFDLENBQUE7UUFD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SUFiVzs7MkJBdUJwQixJQUFBLEdBQU0sU0FBQTtlQUVGO1lBQUEsTUFBQSxFQUFXLElBQUMsQ0FBQSxHQUFGLEdBQU0sTUFBTixHQUFZLElBQUMsQ0FBQSxHQUFiLEdBQWlCLEtBQWpCLEdBQXFCLENBQUMsSUFBQyxDQUFBLEdBQUQsR0FBSyxJQUFDLENBQUEsR0FBUCxDQUFyQixHQUFnQyxLQUFoQyxHQUFxQyxJQUFDLENBQUEsUUFBdEMsR0FBK0MsUUFBekQ7WUFDQSxNQUFBLEVBQVcsSUFBQyxDQUFBLE1BQUYsR0FBUyxhQUFULEdBQXNCLElBQUMsQ0FBQSxTQUF2QixHQUFpQyxjQUFqQyxHQUErQyxJQUFDLENBQUEsVUFBaEQsR0FBMkQsYUFBM0QsR0FBd0UsSUFBQyxDQUFBLFNBQXpFLEdBQW1GLGFBQW5GLEdBQWdHLElBQUMsQ0FBQSxTQUFqRyxHQUEyRyxhQUEzRyxHQUF3SCxJQUFDLENBQUEsU0FEbkk7O0lBRkU7Ozs7R0E5UGlCOztBQW1RM0IsTUFBTSxDQUFDLE9BQVAsR0FBaUIiLCJzb3VyY2VzQ29udGVudCI6WyIjIyNcbjAwMDAwMDAwICAwMDAwMDAwICAgIDAwMCAgMDAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgICAgICAgIDAwMDAwMDAgICAwMDAwMDAwICAwMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwICAgICAgMDAwICAgICAgXG4wMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgICAgIDAwMCAgICAgICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgICAgIFxuMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAgICAgICAwMDAwMDAwICAgMDAwICAgICAgIDAwMDAwMDAgICAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAgICBcbjAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgICAgICAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgICAgXG4wMDAwMDAwMCAgMDAwMDAwMCAgICAwMDAgICAgIDAwMCAgICAgIDAwMDAwMDAgICAwMDAgICAwMDAgICAgICAgIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAgIFxuIyMjXG5cbnsgY2xhbXAsIGtsb2cgfSA9IHJlcXVpcmUgJ2t4aydcblxuZXZlbnRzID0gcmVxdWlyZSAnZXZlbnRzJ1xua3hrICAgID0gcmVxdWlyZSAna3hrJ1xuXG5jbGFzcyBFZGl0b3JTY3JvbGwgZXh0ZW5kcyBldmVudHNcblxuICAgIEA6IChAZWRpdG9yKSAtPlxuXG4gICAgICAgIHN1cGVyKClcbiAgICAgICAgQGxpbmVIZWlnaHQgPSBAZWRpdG9yLnNpemUubGluZUhlaWdodCA/IDBcbiAgICAgICAgQHZpZXdIZWlnaHQgPSAtMVxuICAgICAgICBAaW5pdCgpXG4gICAgICAgIFxuICAgICMgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwMDAwMDAwXG4gICAgIyAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAwMDAgICBcbiAgICAjIDAwMCAgMDAwIDAgMDAwICAwMDAgICAgIDAwMCAgIFxuICAgICMgMDAwICAwMDAgIDAwMDAgIDAwMCAgICAgMDAwICAgXG4gICAgIyAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAwMDAgICBcblxuICAgIGluaXQ6IC0+XG4gICAgICAgIFxuICAgICAgICBAc2Nyb2xsICAgICAgID0gIDAgIyBjdXJyZW50IHNjcm9sbCB2YWx1ZSBmcm9tIGRvY3VtZW50IHN0YXJ0IChwaXhlbHMpXG4gICAgICAgIEBvZmZzZXRUb3AgICAgPSAgMCAjIGhlaWdodCBvZiB2aWV3IGFib3ZlIGZpcnN0IHZpc2libGUgbGluZSAocGl4ZWxzKVxuICAgICAgICBAb2Zmc2V0U21vb3RoID0gIDAgIyBzbW9vdGggc2Nyb2xsaW5nIG9mZnNldCAvIHBhcnQgb2YgdG9wIGxpbmUgdGhhdCBpcyBoaWRkZW4gKHBpeGVscylcbiAgICAgICAgXG4gICAgICAgIEB2aWV3SGVpZ2h0ICAgPSAtMVxuICAgICAgICBAZnVsbEhlaWdodCAgID0gLTEgIyB0b3RhbCBoZWlnaHQgb2YgYnVmZmVyIChwaXhlbHMpXG4gICAgICAgIEBmdWxsTGluZXMgICAgPSAtMSAjIG51bWJlciBvZiBmdWxsIGxpbmVzIGZpdHRpbmcgaW4gdmlldyAoZXhjbHVkaW5nIHBhcnRpYWxzKVxuICAgICAgICBAdmlld0xpbmVzICAgID0gLTEgIyBudW1iZXIgb2YgbGluZXMgZml0dGluZyBpbiB2aWV3IChpbmNsdWRpbmcgcGFydGlhbHMpXG4gICAgICAgIEBzY3JvbGxNYXggICAgPSAtMSAjIG1heGltdW0gc2Nyb2xsIG9mZnNldCAocGl4ZWxzKVxuICAgICAgICBAbnVtTGluZXMgICAgID0gLTEgIyB0b3RhbCBudW1iZXIgb2YgbGluZXMgaW4gYnVmZmVyXG4gICAgICAgIEB0b3AgICAgICAgICAgPSAtMSAjIGluZGV4IG9mIGZpcnN0IHZpc2libGUgbGluZSBpbiB2aWV3XG4gICAgICAgIEBib3QgICAgICAgICAgPSAtMSAjIGluZGV4IG9mIGxhc3QgIHZpc2libGUgbGluZSBpbiB2aWV3XG5cbiAgICBzdGFydDogKEB2aWV3SGVpZ2h0LCBAbnVtTGluZXMpID0+XG4gICAgICAgIFxuICAgICAgICBAZnVsbEhlaWdodCA9IEBudW1MaW5lcyAqIEBsaW5lSGVpZ2h0XG4gICAgICAgIEB0b3AgPSAwXG4gICAgICAgIEBib3QgPSBAdG9wLTFcbiAgICAgICAgQGNhbGMoKVxuICAgICAgICBAYnkgMFxuXG4gICAgIyAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAgICAgMDAwMDAwMCAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAgICAgXG4gICAgIyAwMDAgICAgICAgMDAwMDAwMDAwICAwMDAgICAgICAwMDAgICAgICAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAgICAgXG4gICAgIyAgMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwICAgMDAwMDAwMCAgXG4gICAgXG4gICAgY2FsYzogLT5cbiAgICAgICAgXG4gICAgICAgIGlmIEB2aWV3SGVpZ2h0IDw9IDBcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgXG4gICAgICAgIEBzY3JvbGxNYXggICA9IE1hdGgubWF4KDAsQGZ1bGxIZWlnaHQgLSBAdmlld0hlaWdodCkgICAjIG1heGltdW0gc2Nyb2xsIG9mZnNldCAocGl4ZWxzKVxuICAgICAgICBAZnVsbExpbmVzICAgPSBNYXRoLmZsb29yKEB2aWV3SGVpZ2h0IC8gQGxpbmVIZWlnaHQpICAgIyBudW1iZXIgb2YgbGluZXMgaW4gdmlldyAoZXhjbHVkaW5nIHBhcnRpYWxzKVxuICAgICAgICBAdmlld0xpbmVzICAgPSBNYXRoLmNlaWwoQHZpZXdIZWlnaHQgLyBAbGluZUhlaWdodCkrMSAgIyBudW1iZXIgb2YgbGluZXMgaW4gdmlldyAoaW5jbHVkaW5nIHBhcnRpYWxzKVxuICAgICAgICBcbiAgICAjIDAwMDAwMDAgICAgMDAwICAgMDAwXG4gICAgIyAwMDAgICAwMDAgICAwMDAgMDAwIFxuICAgICMgMDAwMDAwMCAgICAgIDAwMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgICAgMDAwICAgXG4gICAgIyAwMDAwMDAwICAgICAgIDAwMCAgIFxuICAgICAgICBcbiAgICB0bzogKHApID0+IEBieSBwLUBzY3JvbGxcbiAgICBcbiAgICBieTogKGRlbHRhLCB4KSA9PlxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGlmIEB2aWV3TGluZXMgPCAwXG4gICAgICAgIFxuICAgICAgICBAZWRpdG9yLmxheWVyU2Nyb2xsLnNjcm9sbExlZnQgKz0geCBpZiB4XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gaWYgbm90IGRlbHRhIGFuZCBAdG9wIDwgQGJvdFxuICAgICAgICBcbiAgICAgICAgc2Nyb2xsID0gQHNjcm9sbFxuICAgICAgICBkZWx0YSA9IDAgaWYgTnVtYmVyLmlzTmFOIGRlbHRhXG4gICAgICAgIEBzY3JvbGwgPSBwYXJzZUludCBjbGFtcCAwLCBAc2Nyb2xsTWF4LCBAc2Nyb2xsK2RlbHRhXG4gICAgICAgIHRvcCA9IHBhcnNlSW50IEBzY3JvbGwgLyBAbGluZUhlaWdodFxuICAgICAgICBAb2Zmc2V0U21vb3RoID0gQHNjcm9sbCAtIHRvcCAqIEBsaW5lSGVpZ2h0IFxuICAgICAgICBcbiAgICAgICAgQHNldFRvcCB0b3BcblxuICAgICAgICBvZmZzZXQgPSAwXG4gICAgICAgIG9mZnNldCArPSBAb2Zmc2V0U21vb3RoXG4gICAgICAgIG9mZnNldCArPSAodG9wIC0gQHRvcCkgKiBAbGluZUhlaWdodFxuICAgICAgICBcbiAgICAgICAgaWYgb2Zmc2V0ICE9IEBvZmZzZXRUb3Agb3Igc2Nyb2xsICE9IEBzY3JvbGxcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgQG9mZnNldFRvcCA9IHBhcnNlSW50IG9mZnNldFxuICAgICAgICAgICAgQHVwZGF0ZU9mZnNldCgpXG4gICAgICAgICAgICBAZW1pdCAnc2Nyb2xsJyBAc2Nyb2xsLCBAb2Zmc2V0VG9wXG4gICAgICAgICAgICBcbiAgICAjICAwMDAwMDAwICAwMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgICAgICAgIDAwMCAgICAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMFxuICAgICMgMDAwMDAwMCAgIDAwMDAwMDAgICAgICAwMDAgICAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAwMDAwMCBcbiAgICAjICAgICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgXG4gICAgIyAwMDAwMDAwICAgMDAwMDAwMDAgICAgIDAwMCAgICAgICAgMDAwICAgICAgMDAwMDAwMCAgIDAwMCAgICAgIFxuICAgICAgICAgICAgXG4gICAgc2V0VG9wOiAodG9wKSA9PlxuICAgICAgICBcbiAgICAgICAgb2xkVG9wID0gQHRvcFxuICAgICAgICBvbGRCb3QgPSBAYm90XG4gICAgICAgIFxuICAgICAgICBAYm90ID0gTWF0aC5taW4gdG9wK0B2aWV3TGluZXMsIEBudW1MaW5lcy0xXG4gICAgICAgIEB0b3AgPSBNYXRoLm1heCAwLCBAYm90IC0gQHZpZXdMaW5lc1xuXG4gICAgICAgIHJldHVybiBpZiBvbGRUb3AgPT0gQHRvcCBhbmQgb2xkQm90ID09IEBib3RcbiAgICAgICAgICAgIFxuICAgICAgICBpZiAoQHRvcCA+IG9sZEJvdCkgb3IgKEBib3QgPCBvbGRUb3ApIG9yIChvbGRCb3QgPCBvbGRUb3ApIFxuICAgICAgICAgICAgIyBuZXcgcmFuZ2Ugb3V0c2lkZSwgc3RhcnQgZnJvbSBzY3JhdGNoXG4gICAgICAgICAgICBudW0gPSBAYm90IC0gQHRvcCArIDFcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgbnVtID4gMFxuICAgICAgICAgICAgICAgIEBlbWl0ICdzaG93TGluZXMnIEB0b3AsIEBib3QsIG51bVxuXG4gICAgICAgIGVsc2UgICBcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbnVtID0gQHRvcCAtIG9sZFRvcFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAwIDwgTWF0aC5hYnMgbnVtXG4gICAgICAgICAgICAgICAgQGVtaXQgJ3NoaWZ0TGluZXMnIEB0b3AsIEBib3QsIG51bVxuICAgICAgICAgICAgICAgIFxuICAgIGxpbmVJbmRleElzSW5WaWV3OiAobGkpIC0+IEB0b3AgPD0gbGkgPD0gQGJvdFxuICAgIFxuICAgICMgMDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAwICAwMDAwMDAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAgICAgICAgMDAwICAgXG4gICAgIyAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgICAgIDAwMCAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgICAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAgICAwMDAwMDAwMCAgICAgMDAwICAgXG4gICAgXG4gICAgcmVzZXQ6ID0+XG4gICAgICAgIFxuICAgICAgICBAZW1pdCAnY2xlYXJMaW5lcydcbiAgICAgICAgQGluaXQoKVxuICAgICAgICBAdXBkYXRlT2Zmc2V0KClcbiAgICAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgMDAwICAgICAgIDAwMCAwIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAwMDAgICAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgXG4gICAgIyAgMDAwIDAwMCAgIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwICAgMDAwICAwMDAgIDAwMDAgIDAwMDAwMDAwMCAgICAgMDAwICAgXG4gICAgIyAgICAwMDAgICAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgXG4gICAgIyAgICAgMCAgICAgIDAwMCAgMDAwMDAwMDAgIDAwICAgICAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgICAgMDAwICAgXG5cbiAgICBzZXRWaWV3SGVpZ2h0OiAoaCkgPT5cbiAgICAgICAgXG4gICAgICAgIGlmIEB2aWV3SGVpZ2h0ICE9IGhcbiAgICAgICAgICAgIEBib3QgPSBAdG9wLTEgIyBhbHdheXMgZW1pdCBzaG93TGluZXMgaWYgaGVpZ2h0IGNoYW5nZXNcbiAgICAgICAgICAgIEB2aWV3SGVpZ2h0ID0gaFxuICAgICAgICAgICAgQGNhbGMoKVxuICAgICAgICAgICAgQGJ5IDBcbiAgICAgICAgICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwICAgICAwMCAgMDAwICAgICAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAgMDAwMDAwMFxuICAgICMgMDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgICAwMDAgICAgIFxuICAgICMgMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgMDAwICAgICAgMDAwICAwMDAgMCAwMDAgIDAwMDAwMDAgICAwMDAwMDAwIFxuICAgICMgMDAwICAwMDAwICAwMDAgICAwMDAgIDAwMCAwIDAwMCAgMDAwICAgICAgMDAwICAwMDAgIDAwMDAgIDAwMCAgICAgICAgICAgIDAwMFxuICAgICMgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAwMDAwIFxuICAgICAgICBcbiAgICBzZXROdW1MaW5lczogKG4sIG9wdCkgPT5cbiAgICAgICAgXG4gICAgICAgIGlmIEBudW1MaW5lcyAhPSBuXG4gICAgICAgICAgICBAZnVsbEhlaWdodCA9IG4gKiBAbGluZUhlaWdodFxuICAgICAgICAgICAgaWYgblxuICAgICAgICAgICAgICAgIGlmIG9wdD8uc2hvd0xpbmVzICE9IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIEBib3QgPSBAdG9wLTEgIyBhbHdheXMgZW1pdCBzaG93TGluZXMgaWYgbGluZSBudW1iZXIgY2hhbmdlc1xuICAgICAgICAgICAgICAgIEBudW1MaW5lcyA9IG5cbiAgICAgICAgICAgICAgICBAY2FsYygpXG4gICAgICAgICAgICAgICAgQGJ5IDBcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBAaW5pdCgpXG4gICAgICAgICAgICAgICAgQGVtaXQgJ2NsZWFyTGluZXMnICAgICAgICAgICAgIFxuXG4gICAgIyAwMDAgICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwMFxuICAgICMgMDAwICAgICAgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgIDAwMCAgICAgICAgMDAwICAgMDAwICAgICAwMDAgICBcbiAgICAjIDAwMCAgICAgIDAwMCAgMDAwIDAgMDAwICAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAwMDAwICAgMDAwICAwMDAgIDAwMDAgIDAwMDAwMDAwMCAgICAgMDAwICAgXG4gICAgIyAwMDAgICAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgIFxuICAgICMgMDAwMDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgICAwMDAgICBcblxuICAgIHNldExpbmVIZWlnaHQ6IChoKSA9PlxuICAgICAgICAgICAgXG4gICAgICAgIGlmIEBsaW5lSGVpZ2h0ICE9IGhcbiAgICAgICAgICAgIEBsaW5lSGVpZ2h0ID0gaFxuICAgICAgICAgICAgQGZ1bGxIZWlnaHQgPSBAbnVtTGluZXMgKiBAbGluZUhlaWdodFxuICAgICAgICAgICAgQGNhbGMoKVxuICAgICAgICAgICAgQGJ5IDBcblxuICAgICMgIDAwMDAwMDAgICAwMDAwMDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwICAwMDAwMDAwMCAgMDAwMDAwMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAgICAgMDAwICAgICAgICAgIDAwMCAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMCAgICAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgICAwMDAgICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgICAgICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICBcbiAgICAjICAwMDAwMDAwICAgMDAwICAgICAgIDAwMCAgICAgICAwMDAwMDAwICAgMDAwMDAwMDAgICAgIDAwMCAgICAgXG4gICAgXG4gICAgdXBkYXRlT2Zmc2V0OiAtPiBcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgQGVkaXRvci5sYXllcnMuc3R5bGUudHJhbnNmb3JtID0gXCJ0cmFuc2xhdGUzZCgwLC0je0BvZmZzZXRUb3B9cHgsIDApXCJcbiAgICAgICAgICAgIFxuICAgICMgIDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwICAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuICAgICMgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAgICAwMDAgIFxuICAgICAgICAgICAgXG4gICAgY3Vyc29yVG9Ub3A6ICh0b3BEaXN0PTcpIC0+XG4gICAgICAgICAgICAgICAgXG4gICAgICAgIGNwID0gQGVkaXRvci5jdXJzb3JQb3MoKVxuICAgICAgICBcbiAgICAgICAgaWYgY3BbMV0gLSBAdG9wID4gdG9wRGlzdFxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZyA9IFtAdG9wLCBNYXRoLm1heCAwLCBjcFsxXS0xXVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBzbCA9IEBlZGl0b3Iuc2VsZWN0aW9uc0luTGluZUluZGV4UmFuZ2UgcmdcbiAgICAgICAgICAgIGhsID0gQGVkaXRvci5oaWdobGlnaHRzSW5MaW5lSW5kZXhSYW5nZSByZ1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiBzbC5sZW5ndGggPT0gMCA9PSBobC5sZW5ndGhcbiAgICAgICAgICAgICAgICBrbG9nICdjdXJzb3JUb1RvcCcgKGNwWzFdIC0gQHRvcCAtIHRvcERpc3QpXG4gICAgICAgICAgICAgICAgQGJ5IEBsaW5lSGVpZ2h0ICogKGNwWzFdIC0gQHRvcCAtIHRvcERpc3QpXG5cbiAgICBjdXJzb3JJbnRvVmlldzogLT5cblxuICAgICAgICBpZiBkZWx0YSA9IEBkZWx0YVRvRW5zdXJlTWFpbkN1cnNvcklzVmlzaWJsZSgpXG4gICAgICAgICAgICBAYnkgZGVsdGEgKiBAbGluZUhlaWdodCAtIEBvZmZzZXRTbW9vdGhcbiAgICAgICAgICAgIFxuICAgICAgICBAdXBkYXRlQ3Vyc29yT2Zmc2V0KClcblxuICAgIGRlbHRhVG9FbnN1cmVNYWluQ3Vyc29ySXNWaXNpYmxlOiAtPlxuICAgICAgICBcbiAgICAgICAgbWFpbmRlbHRhID0gMFxuICAgICAgICBjbCA9IEBlZGl0b3IubWFpbkN1cnNvcigpWzFdXG4gICAgICAgIFxuICAgICAgICBvZmZzZXQgPSBAZWRpdG9yLmNvbmZpZz8uc2Nyb2xsT2Zmc2V0ID8gMlxuICAgICAgICBcbiAgICAgICAgaWYgY2wgPCBAdG9wICsgb2Zmc2V0ICsgQG9mZnNldFRvcCAvIEBsaW5lSGVpZ2h0XG4gICAgICAgICAgICBtYWluZGVsdGEgPSBjbCAtIChAdG9wICsgb2Zmc2V0ICsgQG9mZnNldFRvcCAvIEBsaW5lSGVpZ2h0KVxuICAgICAgICBlbHNlIGlmIGNsID4gQHRvcCArIEBmdWxsTGluZXMgLSBvZmZzZXQgLSAxXG4gICAgICAgICAgICBtYWluZGVsdGEgPSBjbCAtIChAdG9wICsgQGZ1bGxMaW5lcyAtIG9mZnNldCAtIDEpXG5cbiAgICAgICAgbWFpbmRlbHRhXG4gICAgICAgICAgICBcbiAgICB1cGRhdGVDdXJzb3JPZmZzZXQ6IC0+XG4gICAgICAgIFxuICAgICAgICBvZmZzZXRYICAgICA9IEBlZGl0b3Iuc2l6ZS5vZmZzZXRYXG4gICAgICAgIGNoYXJXaWR0aCAgID0gQGVkaXRvci5zaXplLmNoYXJXaWR0aFxuICAgICAgICBsYXllcnNXaWR0aCA9IEBlZGl0b3IubGF5ZXJzV2lkdGhcbiAgICAgICAgc2Nyb2xsTGVmdCAgPSBAZWRpdG9yLmxheWVyU2Nyb2xsLnNjcm9sbExlZnRcblxuICAgICAgICBjeCA9IEBlZGl0b3IubWFpbkN1cnNvcigpWzBdKmNoYXJXaWR0aCtvZmZzZXRYXG4gICAgICAgIFxuICAgICAgICBpZiBjeC1zY3JvbGxMZWZ0ID4gbGF5ZXJzV2lkdGhcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgQGVkaXRvci5sYXllclNjcm9sbC5zY3JvbGxMZWZ0ID0gTWF0aC5tYXggMCwgY3ggLSBsYXllcnNXaWR0aCArIGNoYXJXaWR0aFxuICAgICAgICAgICAgXG4gICAgICAgIGVsc2UgaWYgY3gtb2Zmc2V0WC1zY3JvbGxMZWZ0IDwgMFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBAZWRpdG9yLmxheWVyU2Nyb2xsLnNjcm9sbExlZnQgPSBNYXRoLm1heCAwLCBjeCAtIG9mZnNldFhcbiAgICAgICAgICAgIFxuICAgICMgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAgMDAwMDAwMCBcbiAgICAjIDAwMCAgMDAwMCAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwXG4gICAgIyAwMDAgIDAwMCAwIDAwMCAgMDAwMDAwICAgIDAwMCAgIDAwMFxuICAgICMgMDAwICAwMDAgIDAwMDAgIDAwMCAgICAgICAwMDAgICAwMDBcbiAgICAjIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgIDAwMDAwMDAgXG4gICAgXG4gICAgaW5mbzogLT5cbiAgICAgICAgXG4gICAgICAgIHRvcGJvdDogXCIje0B0b3B9IC4uICN7QGJvdH0gPSAje0Bib3QtQHRvcH0gLyAje0BudW1MaW5lc30gbGluZXNcIlxuICAgICAgICBzY3JvbGw6IFwiI3tAc2Nyb2xsfSBvZmZzZXRUb3AgI3tAb2Zmc2V0VG9wfSB2aWV3SGVpZ2h0ICN7QHZpZXdIZWlnaHR9IHNjcm9sbE1heCAje0BzY3JvbGxNYXh9IGZ1bGxMaW5lcyAje0BmdWxsTGluZXN9IHZpZXdMaW5lcyAje0B2aWV3TGluZXN9XCJcbiAgICAgICAgXG5tb2R1bGUuZXhwb3J0cyA9IEVkaXRvclNjcm9sbFxuIl19
//# sourceURL=../../coffee/editor/editorscroll.coffee