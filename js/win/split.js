// koffee 1.4.0

/*
 0000000  00000000   000      000  000000000
000       000   000  000      000     000   
0000000   00000000   000      000     000   
     000  000        000      000     000   
0000000   000        0000000  000     000
 */
var $, Flex, Split, _, event, kerror, post, ref,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

ref = require('kxk'), post = ref.post, kerror = ref.kerror, $ = ref.$, _ = ref._;

event = require('events');

Flex = require('./flex/flex');

Split = (function() {
    function Split() {
        this.resized = bind(this.resized, this);
        this.hideTerminal = bind(this.hideTerminal, this);
        this.hideEditor = bind(this.hideEditor, this);
        this.restore = bind(this.restore, this);
        this.stash = bind(this.stash, this);
        this.emitSplit = bind(this.emitSplit, this);
        this.onDrag = bind(this.onDrag, this);
        this.commandlineHeight = 30;
        this.handleHeight = 6;
        this.elem = $('split');
        this.terminal = $('terminal');
        this.browser = $('browser');
        this.commandline = $('commandline');
        this.editor = $('editor');
        post.on('focus', this.focus);
        post.on('stash', this.stash);
        post.on('restore', this.restore);
        this.flex = new Flex({
            panes: [
                {
                    div: this.terminal,
                    collapsed: true
                }, {
                    div: this.commandline,
                    fixed: this.commandlineHeight
                }, {
                    div: this.editor
                }
            ],
            direction: 'vertical',
            handleSize: this.handleHeight,
            onDrag: this.onDrag,
            onDragEnd: this.onDrag,
            onPaneSize: this.onDrag,
            snapFirst: 20,
            snapLast: 100
        });
    }

    Split.prototype.onDrag = function() {
        if (this.flex != null) {
            return this.emitSplit();
        }
    };

    Split.prototype.emitSplit = function() {
        return post.emit('split', this.flex.panePositions());
    };

    Split.prototype.stash = function() {
        window.stash.set('split|flex', this.flex.getState());
        return window.stash.set('split|browser', this.flex.panes[0].div === this.browser);
    };

    Split.prototype.restore = function() {
        var state;
        if (state = window.stash.get('split|flex')) {
            this.flex.restoreState(state);
            this.emitSplit();
        } else {
            this["do"]('maximize editor');
        }
        if (this.flex.panes[0].div !== this.browser && window.stash.get('split|browser')) {
            return this.raise('browser');
        }
    };

    Split.prototype["do"] = function(sentence) {
        var action, delta, pos, what, words;
        sentence = sentence.trim();
        if (!sentence.length) {
            return;
        }
        words = sentence.split(/\s+/);
        action = words[0];
        what = words[1];
        switch (action) {
            case 'show':
                return this.show(what);
            case 'focus':
                return this.focus(what);
            case 'half':
                pos = this.flex.size() / 2;
                break;
            case 'third':
                pos = this.flex.size() / 3;
                break;
            case 'quart':
                pos = this.flex.size() / 4;
                break;
            case 'maximize':
                if (what === 'editor') {
                    return this.maximizeEditor();
                }
                delta = this.flex.size();
                break;
            case 'minimize':
                if (what === 'editor') {
                    return this.minimizeEditor();
                }
                delta = -this.flex.size();
                break;
            case 'enlarge':
                if (words[2] === 'by') {
                    delta = parseInt(words[3]);
                } else {
                    delta = parseInt(0.25 * this.termEditHeight());
                }
                break;
            case 'reduce':
                if (words[2] === 'by') {
                    delta = -parseInt(words[3]);
                } else {
                    delta = -parseInt(0.25 * this.termEditHeight());
                }
                break;
            default:
                return console.error("Split.do -- unknown action '" + action + "'");
        }
        switch (what) {
            case 'editor':
                return this.moveCommandLineBy(-delta);
            case 'terminal':
            case 'browser':
            case 'commandline':
                if (what !== 'commandline') {
                    this.raise(what);
                }
                if (delta != null) {
                    this.moveCommandLineBy(delta);
                }
                if (pos != null) {
                    this.flex.moveHandleToPos(this.flex.handles[0], pos);
                }
                return;
        }
        return console.error("Split.do -- unhandled do command? " + sentence + "?");
    };

    Split.prototype.maximizeEditor = function() {
        this.focus('editor');
        this.flex.expand('editor');
        this.hideCommandline();
        return this.flex.resized();
    };

    Split.prototype.minimizeEditor = function() {
        this.showCommandline();
        this.focus('commandline');
        return this.flex.moveHandleToPos(this.flex.handles[1], this.flex.size());
    };

    Split.prototype.show = function(n) {
        switch (n) {
            case 'terminal':
            case 'browser':
                return this.raise(n);
            case 'editor':
                this.flex.expand('editor');
                if (this.editorHeight() < this.flex.size() / 3) {
                    if (this.flex.handles[1].pos() > this.flex.size() / 3) {
                        this.flex.moveHandleToPos(this.flex.handles[1], this.flex.size() / 3);
                    }
                    if (this.flex.handles[2].pos() < 2 * this.flex.size() / 3) {
                        return this.flex.moveHandleToPos(this.flex.handles[2], 2 * this.flex.size() / 3);
                    }
                }
                break;
            case 'command':
                return this.flex.expand('commandline');
            default:
                return console.error("split.show -- unhandled: " + n + "!");
        }
    };

    Split.prototype.hideEditor = function() {
        return this.flex.collapse('editor');
    };

    Split.prototype.hideTerminal = function() {
        return this.flex.collapse('terminal');
    };

    Split.prototype.swap = function(old, nju) {
        if (this.flex.panes[0].div !== nju) {
            nju.style.height = (this.flex.sizeOfPane(0)) + "px";
            old.style.display = 'none';
            nju.style.display = 'block';
            return this.flex.panes[0].div = nju;
        }
    };

    Split.prototype.raise = function(n) {
        switch (n) {
            case 'terminal':
                this.swap(this.browser, this.terminal);
                break;
            case 'browser':
                this.swap(this.terminal, this.browser);
        }
        this.flex.calculate();
        if (n === 'editor') {
            if (this.editorHeight() < this.flex.size() / 8) {
                return this.flex.moveHandleToPos(this.flex.handles[0], 3 * this.flex.size() / 4);
            }
        } else {
            if (this.terminalHeight() < this.flex.size() / 8) {
                return this.flex.moveHandleToPos(this.flex.handles[0], this.flex.size() / 4);
            }
        }
    };

    Split.prototype.moveCommandLineBy = function(delta) {
        return this.flex.moveHandle({
            index: 1,
            pos: this.flex.posOfHandle(1) + delta
        });
    };

    Split.prototype.hideCommandline = function() {
        if (!this.flex.isCollapsed('commandline')) {
            this.flex.collapse('terminal');
            this.flex.collapse('commandline');
            return post.emit('commandline', 'hidden');
        }
    };

    Split.prototype.showCommandline = function() {
        if (this.flex.isCollapsed('commandline')) {
            this.flex.expand('commandline');
            return post.emit('commandline', 'shown');
        }
    };

    Split.prototype.focus = function(n) {
        var ref1, ref2;
        if (n === 'commandline') {
            n = 'commandline-editor';
        }
        if (n === '.' || ($(n) == null)) {
            return kerror("Split.focus -- can't find element '" + n + "'");
        }
        if (((ref1 = $(n)) != null ? ref1.focus : void 0) != null) {
            window.setLastFocus(n);
        }
        return (ref2 = $(n)) != null ? typeof ref2.focus === "function" ? ref2.focus() : void 0 : void 0;
    };

    Split.prototype.focusAnything = function() {
        if (this.editorVisible()) {
            return this.focus('editor');
        }
        if (this.terminalVisible()) {
            return this.focus('terminal');
        }
        return this.focus('commandline-editor');
    };

    Split.prototype.resized = function() {
        var main;
        main = $('main');
        this.elem.style.width = main.clientWidth + "px";
        this.elem.style.height = main.clientHeight + "px";
        this.flex.resized();
        return this.emitSplit();
    };

    Split.prototype.elemHeight = function() {
        return this.elem.getBoundingClientRect().height - this.handleHeight;
    };

    Split.prototype.splitPosY = function(i) {
        return this.flex.posOfHandle(i);
    };

    Split.prototype.terminalHeight = function() {
        return this.flex.sizeOfPane(0);
    };

    Split.prototype.editorHeight = function() {
        return this.flex.sizeOfPane(2);
    };

    Split.prototype.termEditHeight = function() {
        return this.terminalHeight() + this.commandlineHeight + this.editorHeight();
    };

    Split.prototype.commandlineVisible = function() {
        return !this.flex.isCollapsed('commandline');
    };

    Split.prototype.terminalVisible = function() {
        return !this.flex.isCollapsed('terminal');
    };

    Split.prototype.editorVisible = function() {
        return !this.flex.isCollapsed('editor');
    };

    return Split;

})();

module.exports = Split;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3BsaXQuanMiLCJzb3VyY2VSb290IjoiLiIsInNvdXJjZXMiOlsiIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7Ozs7QUFBQSxJQUFBLDJDQUFBO0lBQUE7O0FBUUEsTUFBeUIsT0FBQSxDQUFRLEtBQVIsQ0FBekIsRUFBRSxlQUFGLEVBQVEsbUJBQVIsRUFBZ0IsU0FBaEIsRUFBbUI7O0FBRW5CLEtBQUEsR0FBUSxPQUFBLENBQVEsUUFBUjs7QUFDUixJQUFBLEdBQVEsT0FBQSxDQUFRLGFBQVI7O0FBRUY7SUFRVyxlQUFBOzs7Ozs7OztRQUVULElBQUMsQ0FBQSxpQkFBRCxHQUFxQjtRQUNyQixJQUFDLENBQUEsWUFBRCxHQUFxQjtRQUVyQixJQUFDLENBQUEsSUFBRCxHQUFjLENBQUEsQ0FBRSxPQUFGO1FBQ2QsSUFBQyxDQUFBLFFBQUQsR0FBYyxDQUFBLENBQUUsVUFBRjtRQUNkLElBQUMsQ0FBQSxPQUFELEdBQWMsQ0FBQSxDQUFFLFNBQUY7UUFDZCxJQUFDLENBQUEsV0FBRCxHQUFjLENBQUEsQ0FBRSxhQUFGO1FBQ2QsSUFBQyxDQUFBLE1BQUQsR0FBYyxDQUFBLENBQUUsUUFBRjtRQUVkLElBQUksQ0FBQyxFQUFMLENBQVEsT0FBUixFQUFtQixJQUFDLENBQUEsS0FBcEI7UUFDQSxJQUFJLENBQUMsRUFBTCxDQUFRLE9BQVIsRUFBbUIsSUFBQyxDQUFBLEtBQXBCO1FBQ0EsSUFBSSxDQUFDLEVBQUwsQ0FBUSxTQUFSLEVBQW1CLElBQUMsQ0FBQSxPQUFwQjtRQUVBLElBQUMsQ0FBQSxJQUFELEdBQVEsSUFBSSxJQUFKLENBQ0o7WUFBQSxLQUFBLEVBQU87Z0JBQ0M7b0JBQUEsR0FBQSxFQUFZLElBQUMsQ0FBQSxRQUFiO29CQUNBLFNBQUEsRUFBWSxJQURaO2lCQURELEVBSUM7b0JBQUEsR0FBQSxFQUFZLElBQUMsQ0FBQSxXQUFiO29CQUNBLEtBQUEsRUFBWSxJQUFDLENBQUEsaUJBRGI7aUJBSkQsRUFPQztvQkFBQSxHQUFBLEVB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QUksSUFBQyxDQUFBLElBQUksQ0FBQyxXQUFOLENBQWtCLFFBQWxCO0lBQVA7Ozs7OztBQUV4QixNQUFNLENBQUMsT0FBUCxHQUFpQiIsInNvdXJjZXNDb250ZW50IjpbIiMjI1xuIDAwMDAwMDAgIDAwMDAwMDAwICAgMDAwICAgICAgMDAwICAwMDAwMDAwMDBcbjAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgICAgMDAwICAgXG4wMDAwMDAwICAgMDAwMDAwMDAgICAwMDAgICAgICAwMDAgICAgIDAwMCAgIFxuICAgICAwMDAgIDAwMCAgICAgICAgMDAwICAgICAgMDAwICAgICAwMDAgICBcbjAwMDAwMDAgICAwMDAgICAgICAgIDAwMDAwMDAgIDAwMCAgICAgMDAwICAgXG4jIyNcblxueyBwb3N0LCBrZXJyb3IsICQsIF8gfSA9IHJlcXVpcmUgJ2t4aydcblxuZXZlbnQgPSByZXF1aXJlICdldmVudHMnXG5GbGV4ICA9IHJlcXVpcmUgJy4vZmxleC9mbGV4J1xuXG5jbGFzcyBTcGxpdFxuICAgIFxuICAgICMgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwMDAwMDAwXG4gICAgIyAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAwMDAgICBcbiAgICAjIDAwMCAgMDAwIDAgMDAwICAwMDAgICAgIDAwMCAgIFxuICAgICMgMDAwICAwMDAgIDAwMDAgIDAwMCAgICAgMDAwICAgXG4gICAgIyAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAwMDAgICBcbiAgICBcbiAgICBjb25zdHJ1Y3RvcjogKCkgLT5cblxuICAgICAgICBAY29tbWFuZGxpbmVIZWlnaHQgPSAzMFxuICAgICAgICBAaGFuZGxlSGVpZ2h0ICAgICAgPSA2XG4gICAgICAgIFxuICAgICAgICBAZWxlbSAgICAgICAgPSQgJ3NwbGl0J1xuICAgICAgICBAdGVybWluYWwgICAgPSQgJ3Rlcm1pbmFsJ1xuICAgICAgICBAYnJvd3NlciAgICAgPSQgJ2Jyb3dzZXInXG4gICAgICAgIEBjb21tYW5kbGluZSA9JCAnY29tbWFuZGxpbmUnXG4gICAgICAgIEBlZGl0b3IgICAgICA9JCAnZWRpdG9yJ1xuXG4gICAgICAgIHBvc3Qub24gJ2ZvY3VzJywgICBAZm9jdXNcbiAgICAgICAgcG9zdC5vbiAnc3Rhc2gnLCAgIEBzdGFzaFxuICAgICAgICBwb3N0Lm9uICdyZXN0b3JlJywgQHJlc3RvcmVcblxuICAgICAgICBAZmxleCA9IG5ldyBGbGV4XG4gICAgICAgICAgICBwYW5lczogW1xuICAgICAgICAgICAgICAgICAgICBkaXY6ICAgICAgICBAdGVybWluYWxcbiAgICAgICAgICAgICAgICAgICAgY29sbGFwc2VkOiAgdHJ1ZVxuICAgICAgICAgICAgICAgICxcbiAgICAgICAgICAgICAgICAgICAgZGl2OiAgICAgICAgQGNvbW1hbmRsaW5lXG4gICAgICAgICAgICAgICAgICAgIGZpeGVkOiAgICAgIEBjb21tYW5kbGluZUhlaWdodFxuICAgICAgICAgICAgICAgICxcbiAgICAgICAgICAgICAgICAgICAgZGl2OiAgICAgICAgQGVkaXRvclxuICAgICAgICAgICAgXVxuICAgICAgICAgICAgZGlyZWN0aW9uOiAgJ3ZlcnRpY2FsJ1xuICAgICAgICAgICAgaGFuZGxlU2l6ZTogQGhhbmRsZUhlaWdodFxuICAgICAgICAgICAgb25EcmFnOiAgICAgQG9uRHJhZ1xuICAgICAgICAgICAgb25EcmFnRW5kOiAgQG9uRHJhZ1xuICAgICAgICAgICAgb25QYW5lU2l6ZTogQG9uRHJhZ1xuICAgICAgICAgICAgc25hcEZpcnN0OiAgMjBcbiAgICAgICAgICAgIHNuYXBMYXN0OiAgIDEwMFxuICAgICAgICAgICAgXG4gICAgb25EcmFnOiA9PiBpZiBAZmxleD8gdGhlbiBAZW1pdFNwbGl0KClcbiAgICBcbiAgICBlbWl0U3BsaXQ6ID0+IHBvc3QuZW1pdCAnc3BsaXQnLCBAZmxleC5wYW5lUG9zaXRpb25zKClcbiAgICBcbiAgICAjICAwMDAwMDAwICAwMDAwMDAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIFxuICAgICMgMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwMDAwMDAwICAwMDAwMDAwICAgMDAwMDAwMDAwICBcbiAgICAjICAgICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgICAgICAwMDAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAwMDAwICAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMDAwMDAgICAwMDAgICAwMDAgIFxuICAgIFxuICAgIHN0YXNoOiA9PiBcbiAgICAgICAgXG4gICAgICAgIHdpbmRvdy5zdGFzaC5zZXQgJ3NwbGl0fGZsZXgnIEBmbGV4LmdldFN0YXRlKClcbiAgICAgICAgd2luZG93LnN0YXNoLnNldCAnc3BsaXR8YnJvd3NlcicgQGZsZXgucGFuZXNbMF0uZGl2ID09IEBicm93c2VyXG4gICAgICAgIFxuICAgIHJlc3RvcmU6ID0+IFxuXG4gICAgICAgIGlmIHN0YXRlID0gd2luZG93LnN0YXNoLmdldCAnc3BsaXR8ZmxleCdcbiAgICAgICAgICAgIEBmbGV4LnJlc3RvcmVTdGF0ZSBzdGF0ZVxuICAgICAgICAgICAgQGVtaXRTcGxpdCgpXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIEBkbyAnbWF4aW1pemUgZWRpdG9yJ1xuICAgICAgICAgICAgXG4gICAgICAgIGlmIEBmbGV4LnBhbmVzWzBdLmRpdiAhPSBAYnJvd3NlciBhbmQgd2luZG93LnN0YXNoLmdldCAnc3BsaXR8YnJvd3NlcidcbiAgICAgICAgICAgIEByYWlzZSAnYnJvd3NlcidcbiAgICAgICAgICAgICAgICBcbiAgICAjIDAwMDAwMDAgICAgIDAwMDAwMDAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAgICAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwXG4gICAgIyAwMDAwMDAwICAgICAwMDAwMDAwIFxuICAgIFxuICAgIGRvOiAoc2VudGVuY2UpIC0+XG4gICAgICAgIFxuICAgICAgICBzZW50ZW5jZSA9IHNlbnRlbmNlLnRyaW0oKVxuICAgICAgICByZXR1cm4gaWYgbm90IHNlbnRlbmNlLmxlbmd0aFxuICAgICAgICB3b3JkcyAgPSBzZW50ZW5jZS5zcGxpdCAvXFxzKy9cbiAgICAgICAgYWN0aW9uID0gd29yZHNbMF1cbiAgICAgICAgd2hhdCAgID0gd29yZHNbMV1cbiAgICAgICAgc3dpdGNoIGFjdGlvblxuICAgICAgICAgICAgd2hlbiAnc2hvdycgICAgIHRoZW4gcmV0dXJuIEBzaG93ICB3aGF0XG4gICAgICAgICAgICB3aGVuICdmb2N1cycgICAgdGhlbiByZXR1cm4gQGZvY3VzIHdoYXRcbiAgICAgICAgICAgIHdoZW4gJ2hhbGYnICAgICB0aGVuIHBvcyAgID0gIEBmbGV4LnNpemUoKS8yXG4gICAgICAgICAgICB3aGVuICd0aGlyZCcgICAgdGhlbiBwb3MgICA9ICBAZmxleC5zaXplKCkvM1xuICAgICAgICAgICAgd2hlbiAncXVhcnQnICAgIHRoZW4gcG9zICAgPSAgQGZsZXguc2l6ZSgpLzRcbiAgICAgICAgICAgIHdoZW4gJ21heGltaXplJyBcbiAgICAgICAgICAgICAgICBpZiB3aGF0ID09ICdlZGl0b3InIHRoZW4gcmV0dXJuIEBtYXhpbWl6ZUVkaXRvcigpXG4gICAgICAgICAgICAgICAgZGVsdGEgPSAgQGZsZXguc2l6ZSgpXG4gICAgICAgICAgICB3aGVuICdtaW5pbWl6ZScgXG4gICAgICAgICAgICAgICAgaWYgd2hhdCA9PSAnZWRpdG9yJyB0aGVuIHJldHVybiBAbWluaW1pemVFZGl0b3IoKVxuICAgICAgICAgICAgICAgIGRlbHRhID0gLUBmbGV4LnNpemUoKVxuICAgICAgICAgICAgd2hlbiAnZW5sYXJnZSdcbiAgICAgICAgICAgICAgICBpZiB3b3Jkc1syXSA9PSAnYnknXG4gICAgICAgICAgICAgICAgICAgIGRlbHRhID0gcGFyc2VJbnQgd29yZHNbM11cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGRlbHRhID0gcGFyc2VJbnQgMC4yNSAqIEB0ZXJtRWRpdEhlaWdodCgpXG4gICAgICAgICAgICB3aGVuICdyZWR1Y2UnXG4gICAgICAgICAgICAgICAgaWYgd29yZHNbMl0gPT0gJ2J5J1xuICAgICAgICAgICAgICAgICAgICBkZWx0YSA9IC0gcGFyc2VJbnQgd29yZHNbM11cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGRlbHRhID0gLSBwYXJzZUludCAwLjI1ICogQHRlcm1FZGl0SGVpZ2h0KClcbiAgICAgICAgICAgIGVsc2UgcmV0dXJuIGVycm9yIFwiU3BsaXQuZG8gLS0gdW5rbm93biBhY3Rpb24gJyN7YWN0aW9ufSdcIlxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgc3dpdGNoIHdoYXRcbiAgICAgICAgICAgIHdoZW4gJ2VkaXRvcicgdGhlbiByZXR1cm4gQG1vdmVDb21tYW5kTGluZUJ5IC1kZWx0YVxuICAgICAgICAgICAgd2hlbiAndGVybWluYWwnLCAnYnJvd3NlcicsICdjb21tYW5kbGluZSdcbiAgICAgICAgICAgICAgICBAcmFpc2Ugd2hhdCBpZiB3aGF0ICE9ICdjb21tYW5kbGluZSdcbiAgICAgICAgICAgICAgICBpZiBkZWx0YT8gdGhlbiBAbW92ZUNvbW1hbmRMaW5lQnkgZGVsdGFcbiAgICAgICAgICAgICAgICBpZiBwb3M/IHRoZW4gQGZsZXgubW92ZUhhbmRsZVRvUG9zIEBmbGV4LmhhbmRsZXNbMF0sIHBvc1xuICAgICAgICAgICAgICAgIHJldHVybiBcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgZXJyb3IgXCJTcGxpdC5kbyAtLSB1bmhhbmRsZWQgZG8gY29tbWFuZD8gI3tzZW50ZW5jZX0/XCJcblxuICAgIG1heGltaXplRWRpdG9yOiAtPiBcbiAgICAgICAgXG4gICAgICAgIEBmb2N1cyAnZWRpdG9yJ1xuICAgICAgICBAZmxleC5leHBhbmQgJ2VkaXRvcidcbiAgICAgICAgQGhpZGVDb21tYW5kbGluZSgpXG4gICAgICAgIEBmbGV4LnJlc2l6ZWQoKVxuXG4gICAgbWluaW1pemVFZGl0b3I6IC0+XG4gICAgICAgIFxuICAgICAgICBAc2hvd0NvbW1hbmRsaW5lKClcbiAgICAgICAgQGZvY3VzICdjb21tYW5kbGluZSdcbiAgICAgICAgQGZsZXgubW92ZUhhbmRsZVRvUG9zIEBmbGV4LmhhbmRsZXNbMV0sIEBmbGV4LnNpemUoKVxuICAgICAgICAgICAgICAgIFxuICAgICMgIDAwMDAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgMCAwMDAgIFxuICAgICMgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMDAgIFxuICAgICMgICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuICAgICMgMDAwMDAwMCAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMCAgICAgMDAgIFxuXG4gICAgc2hvdzogKG4pIC0+XG5cbiAgICAgICAgc3dpdGNoIG5cbiAgICAgICAgICAgIHdoZW4gJ3Rlcm1pbmFsJywgJ2Jyb3dzZXInIHRoZW4gQHJhaXNlIG5cbiAgICAgICAgICAgIHdoZW4gJ2VkaXRvcicgICAgIFxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIEBmbGV4LmV4cGFuZCAnZWRpdG9yJ1xuICAgICAgICAgICAgICAgIGlmIEBlZGl0b3JIZWlnaHQoKSA8IEBmbGV4LnNpemUoKS8zXG4gICAgICAgICAgICAgICAgICAgIGlmIEBmbGV4LmhhbmRsZXNbMV0ucG9zKCkgPiBAZmxleC5zaXplKCkvM1xuICAgICAgICAgICAgICAgICAgICAgICAgQGZsZXgubW92ZUhhbmRsZVRvUG9zIEBmbGV4LmhhbmRsZXNbMV0sIEBmbGV4LnNpemUoKS8zXG4gICAgICAgICAgICAgICAgICAgIGlmIEBmbGV4LmhhbmRsZXNbMl0ucG9zKCkgPCAyKkBmbGV4LnNpemUoKS8zXG4gICAgICAgICAgICAgICAgICAgICAgICBAZmxleC5tb3ZlSGFuZGxlVG9Qb3MgQGZsZXguaGFuZGxlc1syXSwgMipAZmxleC5zaXplKCkvM1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB3aGVuICdjb21tYW5kJyAgICAgICAgICB0aGVuIEBmbGV4LmV4cGFuZCAnY29tbWFuZGxpbmUnXG4gICAgICAgICAgICBlbHNlIGVycm9yIFwic3BsaXQuc2hvdyAtLSB1bmhhbmRsZWQ6ICN7bn0hXCJcblxuICAgIGhpZGVFZGl0b3I6ICAgICA9PiBAZmxleC5jb2xsYXBzZSAnZWRpdG9yJ1xuICAgIGhpZGVUZXJtaW5hbDogICA9PiBAZmxleC5jb2xsYXBzZSAndGVybWluYWwnXG4gICAgICAgICAgICBcbiAgICAjIDAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAgICAwMDAwMDAwICAwMDAwMDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIFxuICAgICMgMDAwMDAwMCAgICAwMDAwMDAwMDAgIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAwMDAgICAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwMDAwICAgMDAwMDAwMDAgIFxuXG4gICAgc3dhcDogKG9sZCwgbmp1KSAtPlxuICAgICAgICBcbiAgICAgICAgaWYgQGZsZXgucGFuZXNbMF0uZGl2ICE9IG5qdVxuICAgICAgICAgICAgbmp1LnN0eWxlLmhlaWdodCAgID0gXCIje0BmbGV4LnNpemVPZlBhbmUgMH1weFwiXG4gICAgICAgICAgICBvbGQuc3R5bGUuZGlzcGxheSAgPSAnbm9uZSdcbiAgICAgICAgICAgIG5qdS5zdHlsZS5kaXNwbGF5ICA9ICdibG9jaydcbiAgICAgICAgICAgIEBmbGV4LnBhbmVzWzBdLmRpdiA9IG5qdVxuXG4gICAgcmFpc2U6IChuKSAtPlxuXG4gICAgICAgIHN3aXRjaCBuXG4gICAgICAgICAgICB3aGVuICd0ZXJtaW5hbCcgdGhlbiBAc3dhcCBAYnJvd3NlciwgQHRlcm1pbmFsXG4gICAgICAgICAgICB3aGVuICdicm93c2VyJyAgdGhlbiBAc3dhcCBAdGVybWluYWwsIEBicm93c2VyXG4gICAgICAgICAgICBcbiAgICAgICAgQGZsZXguY2FsY3VsYXRlKClcblxuICAgICAgICBpZiBuID09ICdlZGl0b3InXG4gICAgICAgICAgICBpZiBAZWRpdG9ySGVpZ2h0KCkgPCBAZmxleC5zaXplKCkvOFxuICAgICAgICAgICAgICAgIEBmbGV4Lm1vdmVIYW5kbGVUb1BvcyBAZmxleC5oYW5kbGVzWzBdLCAzKkBmbGV4LnNpemUoKS80XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGlmIEB0ZXJtaW5hbEhlaWdodCgpIDwgQGZsZXguc2l6ZSgpLzhcbiAgICAgICAgICAgICAgICBAZmxleC5tb3ZlSGFuZGxlVG9Qb3MgQGZsZXguaGFuZGxlc1swXSwgQGZsZXguc2l6ZSgpLzRcblxuICAgICMgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAgICAgIDAwICAwMCAgICAgMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwICAgIDAwMCAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgMDAwMCAgMDAwICAwMDAgICAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgMDAwIDAgMDAwICAwMDAwMDAwIFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwICAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgMDAwICAwMDAwICAwMDAgICAgIFxuICAgICMgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwICAgIDAwMDAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMFxuICAgIFxuICAgIG1vdmVDb21tYW5kTGluZUJ5OiAoZGVsdGEpIC0+XG4gICAgICAgIFxuICAgICAgICBAZmxleC5tb3ZlSGFuZGxlIGluZGV4OjEsIHBvczpAZmxleC5wb3NPZkhhbmRsZSgxKSArIGRlbHRhXG4gICAgICAgIFxuICAgIGhpZGVDb21tYW5kbGluZTogLT4gXG4gICAgICAgIFxuICAgICAgICBpZiBub3QgQGZsZXguaXNDb2xsYXBzZWQgJ2NvbW1hbmRsaW5lJ1xuICAgICAgICAgICAgQGZsZXguY29sbGFwc2UgJ3Rlcm1pbmFsJ1xuICAgICAgICAgICAgQGZsZXguY29sbGFwc2UgJ2NvbW1hbmRsaW5lJ1xuICAgICAgICAgICAgcG9zdC5lbWl0ICdjb21tYW5kbGluZScsICdoaWRkZW4nXG4gICAgICAgIFxuICAgIHNob3dDb21tYW5kbGluZTogLT5cbiAgICAgICAgXG4gICAgICAgIGlmIEBmbGV4LmlzQ29sbGFwc2VkICdjb21tYW5kbGluZSdcbiAgICAgICAgICAgIEBmbGV4LmV4cGFuZCAnY29tbWFuZGxpbmUnXG4gICAgICAgICAgICBwb3N0LmVtaXQgJ2NvbW1hbmRsaW5lJywgJ3Nob3duJ1xuXG4gICAgIyAwMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICBcbiAgICAjIDAwMDAwMCAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMDAwMDAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAgICAgIDAwMFxuICAgICMgMDAwICAgICAgICAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCBcbiAgICBcbiAgICBmb2N1czogKG4pIC0+XG4gICAgICAgIFxuICAgICAgICBuID0gJ2NvbW1hbmRsaW5lLWVkaXRvcicgaWYgbiA9PSAnY29tbWFuZGxpbmUnXG4gICAgICAgIGlmIG4gPT0gJy4nIG9yIG5vdCAkKG4pP1xuICAgICAgICAgICAgcmV0dXJuIGtlcnJvciBcIlNwbGl0LmZvY3VzIC0tIGNhbid0IGZpbmQgZWxlbWVudCAnI3tufSdcIlxuICAgICAgICAgICAgXG4gICAgICAgIHdpbmRvdy5zZXRMYXN0Rm9jdXMgbiBpZiAkKG4pPy5mb2N1cz9cbiAgICAgICAgJChuKT8uZm9jdXM/KClcbiAgICAgICAgICAgIFxuICAgIGZvY3VzQW55dGhpbmc6IC0+XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gQGZvY3VzICdlZGl0b3InICAgaWYgQGVkaXRvclZpc2libGUoKVxuICAgICAgICByZXR1cm4gQGZvY3VzICd0ZXJtaW5hbCcgaWYgQHRlcm1pbmFsVmlzaWJsZSgpXG4gICAgICAgIEBmb2N1cyAnY29tbWFuZGxpbmUtZWRpdG9yJ1xuXG4gICAgIyAwMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwMDAwMCAgMDAwICAwMDAwMDAwICAwMDAwMDAwMCAgMDAwMDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgICAgMDAwICAgICAwMDAgICAwMDAgICAgICAgMDAwICAgMDAwXG4gICAgIyAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgIDAwMCAgICAwMDAwMDAwICAgMDAwICAgMDAwXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAgICAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgICAgMDAwICAgMDAwXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAwMDAwICAgMDAwICAwMDAwMDAwICAwMDAwMDAwMCAgMDAwMDAwMCAgXG4gICAgXG4gICAgcmVzaXplZDogPT5cbiAgICAgICAgXG4gICAgICAgIG1haW4gPSQgJ21haW4nXG4gICAgICAgIEBlbGVtLnN0eWxlLndpZHRoICA9IFwiI3ttYWluLmNsaWVudFdpZHRofXB4XCJcbiAgICAgICAgQGVsZW0uc3R5bGUuaGVpZ2h0ID0gXCIje21haW4uY2xpZW50SGVpZ2h0fXB4XCJcbiAgICAgICAgQGZsZXgucmVzaXplZCgpXG4gICAgICAgIEBlbWl0U3BsaXQoKVxuICAgIFxuICAgICMgMDAwMDAwMDAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAgICAgICAgIDAwMDAwMDAgIDAwMCAgMDAwMDAwMCAgMDAwMDAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgICAwICAgIDAwMCAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgICAgXG4gICAgIyAwMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgIDAwMDAwICAwMDAwMDAwICAgMDAwICAgIDAwMCAgICAwMDAwMDAwIFxuICAgICMgMDAwICAgICAgICAwMDAgICAwMDAgICAgICAgMDAwICAgIDAgICAgICAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcbiAgICAjIDAwMCAgICAgICAgIDAwMDAwMDAgICAwMDAwMDAwICAgICAgICAgIDAwMDAwMDAgICAwMDAgIDAwMDAwMDAgIDAwMDAwMDAwXG4gICAgXG4gICAgZWxlbUhlaWdodDogLT4gQGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0IC0gQGhhbmRsZUhlaWdodFxuICAgIFxuICAgIHNwbGl0UG9zWTogIChpKSAtPiBAZmxleC5wb3NPZkhhbmRsZSBpXG4gICAgdGVybWluYWxIZWlnaHQ6IC0+IEBmbGV4LnNpemVPZlBhbmUgMFxuICAgIGVkaXRvckhlaWdodDogICAtPiBAZmxleC5zaXplT2ZQYW5lIDJcbiAgICB0ZXJtRWRpdEhlaWdodDogLT4gQHRlcm1pbmFsSGVpZ2h0KCkgKyBAY29tbWFuZGxpbmVIZWlnaHQgKyBAZWRpdG9ySGVpZ2h0KClcbiAgICAgICAgXG4gICAgY29tbWFuZGxpbmVWaXNpYmxlOiAtPiBub3QgQGZsZXguaXNDb2xsYXBzZWQgJ2NvbW1hbmRsaW5lJ1xuICAgIHRlcm1pbmFsVmlzaWJsZTogICAgLT4gbm90IEBmbGV4LmlzQ29sbGFwc2VkICd0ZXJtaW5hbCdcbiAgICBlZGl0b3JWaXNpYmxlOiAgICAgIC0+IG5vdCBAZmxleC5pc0NvbGxhcHNlZCAnZWRpdG9yJ1xuICAgICAgICBcbm1vZHVsZS5leHBvcnRzID0gU3BsaXRcbiJdfQ==
//# sourceURL=../../coffee/win/split.coffee